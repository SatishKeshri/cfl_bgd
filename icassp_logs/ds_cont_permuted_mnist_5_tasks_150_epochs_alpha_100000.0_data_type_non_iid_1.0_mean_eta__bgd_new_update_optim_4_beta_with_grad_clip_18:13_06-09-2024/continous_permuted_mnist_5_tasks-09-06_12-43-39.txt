[2024-09-06 12:43:39 Info] Script args: Namespace(dataset='ds_cont_permuted_mnist', nn_arch='mnist_simple_net_200width_domainlearning_784input_10cls_1ds', logname='continous_permuted_mnist_5_tasks', results_dir='ds_cont_permuted_mnist_5_tasks_150_epochs_alpha_100000.0_data_type_non_iid_1.0_mean_eta__bgd_new_update_optim_4_beta_with_grad_clip_18:13_06-09-2024', seed=1000, num_workers=1, num_epochs=150, batch_size=32, pruning_percents=[], train_mc_iters=10, std_init=0.05, mean_eta=1.0, permanent_prune_on_epoch=-1, permanent_prune_on_epoch_percent=90, momentum=0.9, lr=0.01, weight_decay=0.0005, test_freq=1, contpermuted_beta=4, optimizer='bgd_new_update', optimizer_params='{}', inference_mc=False, inference_map=True, inference_committee=False, inference_aggsoftmax=False, inference_initstd=False, committee_size=0, test_mc_iters=0, init_params=['{"bias_type":', '"xavier",', '"conv_type":', '"xavier",', '"bn_init":', '"01"}'], desc='', bw_to_rgb=False, permuted_offset=False, labels_trick=False, num_of_permutations=4, iterations_per_virtual_epc=469, separate_labels_space=False, permute_seed=2019, federated_learning=True, n_clients=5, num_aggs_per_task=10, grad_clip=True, max_grad_norm=1.0, non_iid_split=True, alpha=100000.0, alpha_mg=0.5)
[2024-09-06 12:43:39 Info] Computer name: iiitd with pytorch version: 2.0.1
[2024-09-06 12:43:39 Info] Arguments are Namespace(dataset='ds_cont_permuted_mnist', nn_arch='mnist_simple_net_200width_domainlearning_784input_10cls_1ds', logname='continous_permuted_mnist_5_tasks', results_dir='ds_cont_permuted_mnist_5_tasks_150_epochs_alpha_100000.0_data_type_non_iid_1.0_mean_eta__bgd_new_update_optim_4_beta_with_grad_clip_18:13_06-09-2024', seed=1000, num_workers=1, num_epochs=150, batch_size=32, pruning_percents=[], train_mc_iters=10, std_init=0.05, mean_eta=1.0, permanent_prune_on_epoch=-1, permanent_prune_on_epoch_percent=90, momentum=0.9, lr=0.01, weight_decay=0.0005, test_freq=1, contpermuted_beta=4, optimizer='bgd_new_update', optimizer_params='{}', inference_mc=False, inference_map=True, inference_committee=False, inference_aggsoftmax=False, inference_initstd=False, committee_size=0, test_mc_iters=0, init_params=['{"bias_type":', '"xavier",', '"conv_type":', '"xavier",', '"bn_init":', '"01"}'], desc='', bw_to_rgb=False, permuted_offset=False, labels_trick=False, num_of_permutations=4, iterations_per_virtual_epc=469, separate_labels_space=False, permute_seed=2019, federated_learning=True, n_clients=5, num_aggs_per_task=10, grad_clip=True, max_grad_norm=1.0, non_iid_split=True, alpha=100000.0, alpha_mg=0.5)
[2024-09-06 12:45:00 Info] Transformed model to CUDA
[2024-09-06 12:45:00 Info] Initialized 0 Conv2d layers using nn.init.xavier_normal_
[2024-09-06 12:45:00 Info] Initialized 3 linear layers using xavier
[2024-09-06 12:45:00 Info] Initialized 0 bias conv2d layers using nn.init.xavier.noraml_
[2024-09-06 12:45:00 Info] Initialized 3 bias linear layers using xavier
[2024-09-06 12:45:00 Info] Initialized 0 BN layers using weight=1 and bias=0
[2024-09-06 12:45:00 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.5}
[2024-09-06 12:45:00 Info] Inference method: {'map'}
[2024-09-06 12:45:00 Info] Number of parameters in the model is 199,210
[2024-09-06 12:45:00 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-06 12:45:00 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.5}
[2024-09-06 12:45:00 Info] Gradient clipping with max_norm being done
[2024-09-06 12:45:00 Info] Training epoch number 1 with dataset number 0
[2024-09-06 12:45:11 Info] Client id 0, Epoch 1, train set, Iter 500 current average loss 2.4771
[2024-09-06 12:45:21 Info] Client id 0, Epoch 1, train set, Iter 1000 current average loss 2.4816
[2024-09-06 12:45:33 Info] Client id 0, Epoch 1, train set, Iter 1500 current average loss 2.4815
[2024-09-06 12:45:39 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-06 12:45:40 Info] Stats for test [map] set of size 10000, loss is 2.3537, acc is 10.29%
[2024-09-06 12:45:40 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-06 12:45:42 Info] Stats for test [map] set of size 10000, loss is 2.4378, acc is 8.77%
[2024-09-06 12:45:42 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-06 12:45:44 Info] Stats for test [map] set of size 10000, loss is 2.404, acc is 13.45%
[2024-09-06 12:45:44 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-06 12:45:46 Info] Stats for test [map] set of size 10000, loss is 2.3979, acc is 10.38%
[2024-09-06 12:45:46 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-06 12:45:48 Info] Stats for test [map] set of size 10000, loss is 2.4138, acc is 10.89%
[2024-09-06 12:45:48 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 10.756
[2024-09-06 12:45:48 Info] Finished epoch number 1, Took 47 seconds
[2024-09-06 12:45:48 Info] Inference method: {'map'}
[2024-09-06 12:45:48 Info] Number of parameters in the model is 199,210
[2024-09-06 12:45:48 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-06 12:45:48 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.5}
[2024-09-06 12:45:48 Info] Gradient clipping with max_norm being done
[2024-09-06 12:45:48 Info] Training epoch number 1 with dataset number 0
[2024-09-06 12:45:59 Info] Client id 1, Epoch 1, train set, Iter 500 current average loss 2.4804
[2024-09-06 12:46:09 Info] Client id 1, Epoch 1, train set, Iter 1000 current average loss 2.483
[2024-09-06 12:46:21 Info] Client id 1, Epoch 1, train set, Iter 1500 current average loss 2.4797
[2024-09-06 12:46:27 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-06 12:46:28 Info] Stats for test [map] set of size 10000, loss is 2.3481, acc is 9.35%
[2024-09-06 12:46:28 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-06 12:46:30 Info] Stats for test [map] set of size 10000, loss is 2.4329, acc is 9.04%
[2024-09-06 12:46:30 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-06 12:46:32 Info] Stats for test [map] set of size 10000, loss is 2.4006, acc is 12.84%
[2024-09-06 12:46:32 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-06 12:46:34 Info] Stats for test [map] set of size 10000, loss is 2.3967, acc is 10.37%
[2024-09-06 12:46:34 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-06 12:46:36 Info] Stats for test [map] set of size 10000, loss is 2.4095, acc is 10.97%
[2024-09-06 12:46:36 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 10.514
[2024-09-06 12:46:36 Info] Finished epoch number 1, Took 47 seconds
[2024-09-06 12:46:36 Info] Inference method: {'map'}
[2024-09-06 12:46:36 Info] Number of parameters in the model is 199,210
[2024-09-06 12:46:36 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-06 12:46:36 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.5}
[2024-09-06 12:46:36 Info] Gradient clipping with max_norm being done
[2024-09-06 12:46:36 Info] Training epoch number 1 with dataset number 0
[2024-09-06 12:46:48 Info] Client id 2, Epoch 1, train set, Iter 500 current average loss 2.4732
[2024-09-06 12:46:58 Info] Client id 2, Epoch 1, train set, Iter 1000 current average loss 2.4718
[2024-09-06 12:47:09 Info] Client id 2, Epoch 1, train set, Iter 1500 current average loss 2.4714
[2024-09-06 12:47:16 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-06 12:47:17 Info] Stats for test [map] set of size 10000, loss is 2.3525, acc is 10.11%
[2024-09-06 12:47:17 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-06 12:47:19 Info] Stats for test [map] set of size 10000, loss is 2.4377, acc is 9.16%
[2024-09-06 12:47:19 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-06 12:47:21 Info] Stats for test [map] set of size 10000, loss is 2.4051, acc is 13.12%
[2024-09-06 12:47:21 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-06 12:47:23 Info] Stats for test [map] set of size 10000, loss is 2.4016, acc is 10.38%
[2024-09-06 12:47:23 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-06 12:47:25 Info] Stats for test [map] set of size 10000, loss is 2.4131, acc is 11.16%
[2024-09-06 12:47:25 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 10.786
[2024-09-06 12:47:25 Info] Finished epoch number 1, Took 49 seconds
[2024-09-06 12:47:25 Info] Inference method: {'map'}
[2024-09-06 12:47:25 Info] Number of parameters in the model is 199,210
[2024-09-06 12:47:25 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-06 12:47:25 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.5}
[2024-09-06 12:47:25 Info] Gradient clipping with max_norm being done
[2024-09-06 12:47:25 Info] Training epoch number 1 with dataset number 0
[2024-09-06 12:47:37 Info] Client id 3, Epoch 1, train set, Iter 500 current average loss 2.4717
[2024-09-06 12:47:48 Info] Client id 3, Epoch 1, train set, Iter 1000 current average loss 2.4767
[2024-09-06 12:48:00 Info] Client id 3, Epoch 1, train set, Iter 1500 current average loss 2.4778
[2024-09-06 12:48:06 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-06 12:48:07 Info] Stats for test [map] set of size 10000, loss is 2.3549, acc is 10.06%
[2024-09-06 12:48:07 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-06 12:48:09 Info] Stats for test [map] set of size 10000, loss is 2.4389, acc is 8.71%
[2024-09-06 12:48:09 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-06 12:48:11 Info] Stats for test [map] set of size 10000, loss is 2.4057, acc is 13.7%
[2024-09-06 12:48:11 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-06 12:48:13 Info] Stats for test [map] set of size 10000, loss is 2.4006, acc is 10.36%
[2024-09-06 12:48:13 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-06 12:48:15 Info] Stats for test [map] set of size 10000, loss is 2.4148, acc is 10.83%
[2024-09-06 12:48:15 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 10.732
[2024-09-06 12:48:15 Info] Finished epoch number 1, Took 50 seconds
[2024-09-06 12:48:15 Info] Inference method: {'map'}
[2024-09-06 12:48:15 Info] Number of parameters in the model is 199,210
[2024-09-06 12:48:15 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-06 12:48:15 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.5}
[2024-09-06 12:48:15 Info] Gradient clipping with max_norm being done
[2024-09-06 12:48:15 Info] Training epoch number 1 with dataset number 0
[2024-09-06 12:48:26 Info] Client id 4, Epoch 1, train set, Iter 500 current average loss 2.4721
[2024-09-06 12:48:36 Info] Client id 4, Epoch 1, train set, Iter 1000 current average loss 2.4695
[2024-09-06 12:48:47 Info] Client id 4, Epoch 1, train set, Iter 1500 current average loss 2.4672
[2024-09-06 12:48:54 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-06 12:48:55 Info] Stats for test [map] set of size 10000, loss is 2.3514, acc is 9.87%
[2024-09-06 12:48:55 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-06 12:48:56 Info] Stats for test [map] set of size 10000, loss is 2.4359, acc is 8.79%
[2024-09-06 12:48:56 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-06 12:48:58 Info] Stats for test [map] set of size 10000, loss is 2.4042, acc is 13.45%
[2024-09-06 12:48:58 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-06 12:49:00 Info] Stats for test [map] set of size 10000, loss is 2.4002, acc is 10.38%
[2024-09-06 12:49:00 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-06 12:49:02 Info] Stats for test [map] set of size 10000, loss is 2.4153, acc is 11.0%
[2024-09-06 12:49:02 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 10.698
[2024-09-06 12:49:02 Info] Finished epoch number 1, Took 47 seconds
[2024-09-06 12:49:03 Info] Task wise accuracies after round 1 are [10.29]
[2024-09-06 12:49:03 Info] Client 0 task-wise loss and accuracies are - ([2.354], [10.29])
[2024-09-06 12:49:04 Info] Task wise accuracies after round 1 are [9.35]
[2024-09-06 12:49:04 Info] Client 1 task-wise loss and accuracies are - ([2.348], [9.35])
[2024-09-06 12:49:05 Info] Task wise accuracies after round 1 are [10.11]
[2024-09-06 12:49:05 Info] Client 2 task-wise loss and accuracies are - ([2.352], [10.11])
[2024-09-06 12:49:06 Info] Task wise accuracies after round 1 are [10.06]
[2024-09-06 12:49:06 Info] Client 3 task-wise loss and accuracies are - ([2.355], [10.06])
[2024-09-06 12:49:07 Info] Task wise accuracies after round 1 are [9.87]
[2024-09-06 12:49:07 Info] Client 4 task-wise loss and accuracies are - ([2.351], [9.87])
[2024-09-06 12:49:08 Info] Task wise accuracies after round 1 are [6.18]
[2024-09-06 12:49:08 Info] Value of server model at round 1 is 18.508403778076172
[2024-09-06 12:49:08 Info] Aggregated model avg acc and avg loss - (6.18, 2.556)
[2024-09-06 12:49:08 Info] Round - 1 complete
[2024-09-06 12:49:08 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.5}
[2024-09-06 12:49:08 Info] Gradient clipping with max_norm being done
[2024-09-06 12:49:08 Info] Training epoch number 2 with dataset number 0
[2024-09-06 12:49:20 Info] Client id 0, Epoch 2, train set, Iter 500 current average loss 2.4291
[2024-09-06 12:49:30 Info] Client id 0, Epoch 2, train set, Iter 1000 current average loss 2.4333
[2024-09-06 12:49:42 Info] Client id 0, Epoch 2, train set, Iter 1500 current average loss 2.4352
[2024-09-06 12:49:49 Info] Running test set for epoch number 2 for dataset idx 0 using map
[2024-09-06 12:49:50 Info] Stats for test [map] set of size 10000, loss is 2.3172, acc is 13.91%
[2024-09-06 12:49:50 Info] Running test set for epoch number 2 for dataset idx 1 using map
[2024-09-06 12:49:51 Info] Stats for test [map] set of size 10000, loss is 2.4294, acc is 7.83%
[2024-09-06 12:49:51 Info] Running test set for epoch number 2 for dataset idx 2 using map
[2024-09-06 12:49:53 Info] Stats for test [map] set of size 10000, loss is 2.3961, acc is 13.93%
[2024-09-06 12:49:53 Info] Running test set for epoch number 2 for dataset idx 3 using map
[2024-09-06 12:49:55 Info] Stats for test [map] set of size 10000, loss is 2.387, acc is 10.51%
[2024-09-06 12:49:55 Info] Running test set for epoch number 2 for dataset idx 4 using map
[2024-09-06 12:49:57 Info] Stats for test [map] set of size 10000, loss is 2.4058, acc is 10.53%
[2024-09-06 12:49:57 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 4 using map is 11.342
[2024-09-06 12:49:57 Info] Finished epoch number 2, Took 49 seconds
[2024-09-06 12:49:57 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.5}
[2024-09-06 12:49:57 Info] Gradient clipping with max_norm being done
[2024-09-06 12:49:57 Info] Training epoch number 2 with dataset number 0
[2024-09-06 12:50:09 Info] Client id 1, Epoch 2, train set, Iter 500 current average loss 2.4336
