[2024-09-06 13:04:06 Info] Script args: Namespace(dataset='ds_cont_permuted_mnist', nn_arch='mnist_simple_net_200width_domainlearning_784input_10cls_1ds', logname='continous_permuted_mnist_5_tasks', results_dir='ds_cont_permuted_mnist_5_tasks_150_epochs_alpha_100000.0_data_type_non_iid_3.0_mean_eta__bgd_new_update_optim_4_beta_with_grad_clip_18:34_06-09-2024', seed=1000, num_workers=1, num_epochs=150, batch_size=32, pruning_percents=[], train_mc_iters=10, std_init=0.05, mean_eta=3.0, permanent_prune_on_epoch=-1, permanent_prune_on_epoch_percent=90, momentum=0.9, lr=0.01, weight_decay=0.0005, test_freq=1, contpermuted_beta=4, optimizer='bgd_new_update', optimizer_params='{}', inference_mc=False, inference_map=True, inference_committee=False, inference_aggsoftmax=False, inference_initstd=False, committee_size=0, test_mc_iters=0, init_params=['{"bias_type":', '"xavier",', '"conv_type":', '"xavier",', '"bn_init":', '"01"}'], desc='', bw_to_rgb=False, permuted_offset=False, labels_trick=False, num_of_permutations=4, iterations_per_virtual_epc=469, separate_labels_space=False, permute_seed=2019, federated_learning=True, n_clients=5, num_aggs_per_task=10, grad_clip=True, max_grad_norm=1.0, non_iid_split=True, alpha=100000.0, alpha_mg=0.2)
[2024-09-06 13:04:06 Info] Computer name: iiitd with pytorch version: 2.0.1
[2024-09-06 13:04:06 Info] Arguments are Namespace(dataset='ds_cont_permuted_mnist', nn_arch='mnist_simple_net_200width_domainlearning_784input_10cls_1ds', logname='continous_permuted_mnist_5_tasks', results_dir='ds_cont_permuted_mnist_5_tasks_150_epochs_alpha_100000.0_data_type_non_iid_3.0_mean_eta__bgd_new_update_optim_4_beta_with_grad_clip_18:34_06-09-2024', seed=1000, num_workers=1, num_epochs=150, batch_size=32, pruning_percents=[], train_mc_iters=10, std_init=0.05, mean_eta=3.0, permanent_prune_on_epoch=-1, permanent_prune_on_epoch_percent=90, momentum=0.9, lr=0.01, weight_decay=0.0005, test_freq=1, contpermuted_beta=4, optimizer='bgd_new_update', optimizer_params='{}', inference_mc=False, inference_map=True, inference_committee=False, inference_aggsoftmax=False, inference_initstd=False, committee_size=0, test_mc_iters=0, init_params=['{"bias_type":', '"xavier",', '"conv_type":', '"xavier",', '"bn_init":', '"01"}'], desc='', bw_to_rgb=False, permuted_offset=False, labels_trick=False, num_of_permutations=4, iterations_per_virtual_epc=469, separate_labels_space=False, permute_seed=2019, federated_learning=True, n_clients=5, num_aggs_per_task=10, grad_clip=True, max_grad_norm=1.0, non_iid_split=True, alpha=100000.0, alpha_mg=0.2)
[2024-09-06 13:05:40 Info] Transformed model to CUDA
[2024-09-06 13:05:40 Info] Initialized 0 Conv2d layers using nn.init.xavier_normal_
[2024-09-06 13:05:40 Info] Initialized 3 linear layers using xavier
[2024-09-06 13:05:40 Info] Initialized 0 bias conv2d layers using nn.init.xavier.noraml_
[2024-09-06 13:05:40 Info] Initialized 3 bias linear layers using xavier
[2024-09-06 13:05:40 Info] Initialized 0 BN layers using weight=1 and bias=0
[2024-09-06 13:05:40 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
[2024-09-06 13:05:40 Info] Inference method: {'map'}
[2024-09-06 13:05:40 Info] Number of parameters in the model is 199,210
[2024-09-06 13:05:40 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-06 13:05:40 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
[2024-09-06 13:05:40 Info] Gradient clipping with max_norm being done
[2024-09-06 13:05:40 Info] Training epoch number 1 with dataset number 0
[2024-09-06 13:06:02 Info] Client id 0, Epoch 1, train set, Iter 500 current average loss 2.3005
[2024-09-06 13:06:27 Info] Client id 0, Epoch 1, train set, Iter 1000 current average loss 2.2999
[2024-09-06 13:06:55 Info] Client id 0, Epoch 1, train set, Iter 1500 current average loss 2.3009
[2024-09-06 13:07:11 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-06 13:07:14 Info] Stats for test [map] set of size 10000, loss is 2.171, acc is 26.64%
[2024-09-06 13:07:14 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-06 13:07:17 Info] Stats for test [map] set of size 10000, loss is 2.4104, acc is 6.92%
[2024-09-06 13:07:17 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-06 13:07:19 Info] Stats for test [map] set of size 10000, loss is 2.3772, acc is 15.5%
[2024-09-06 13:07:19 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-06 13:07:22 Info] Stats for test [map] set of size 10000, loss is 2.3586, acc is 10.41%
[2024-09-06 13:07:22 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-06 13:07:25 Info] Stats for test [map] set of size 10000, loss is 2.3844, acc is 10.75%
[2024-09-06 13:07:25 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 14.044
[2024-09-06 13:07:25 Info] Finished epoch number 1, Took 104 seconds
[2024-09-06 13:07:25 Info] Inference method: {'map'}
[2024-09-06 13:07:25 Info] Number of parameters in the model is 199,210
[2024-09-06 13:07:25 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-06 13:07:25 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
[2024-09-06 13:07:25 Info] Gradient clipping with max_norm being done
[2024-09-06 13:07:25 Info] Training epoch number 1 with dataset number 0
[2024-09-06 13:07:54 Info] Client id 1, Epoch 1, train set, Iter 500 current average loss 2.3033
[2024-09-06 13:08:22 Info] Client id 1, Epoch 1, train set, Iter 1000 current average loss 2.3057
[2024-09-06 13:08:52 Info] Client id 1, Epoch 1, train set, Iter 1500 current average loss 2.3037
[2024-09-06 13:09:08 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-06 13:09:10 Info] Stats for test [map] set of size 10000, loss is 2.1423, acc is 27.73%
[2024-09-06 13:09:10 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-06 13:09:13 Info] Stats for test [map] set of size 10000, loss is 2.3947, acc is 6.96%
[2024-09-06 13:09:13 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-06 13:09:15 Info] Stats for test [map] set of size 10000, loss is 2.3644, acc is 14.76%
[2024-09-06 13:09:15 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-06 13:09:18 Info] Stats for test [map] set of size 10000, loss is 2.3499, acc is 10.37%
[2024-09-06 13:09:18 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-06 13:09:21 Info] Stats for test [map] set of size 10000, loss is 2.3696, acc is 10.28%
[2024-09-06 13:09:21 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 14.02
[2024-09-06 13:09:21 Info] Finished epoch number 1, Took 116 seconds
[2024-09-06 13:09:21 Info] Inference method: {'map'}
[2024-09-06 13:09:21 Info] Number of parameters in the model is 199,210
[2024-09-06 13:09:21 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-06 13:09:21 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
[2024-09-06 13:09:21 Info] Gradient clipping with max_norm being done
[2024-09-06 13:09:21 Info] Training epoch number 1 with dataset number 0
[2024-09-06 13:09:51 Info] Client id 2, Epoch 1, train set, Iter 500 current average loss 2.2967
[2024-09-06 13:10:18 Info] Client id 2, Epoch 1, train set, Iter 1000 current average loss 2.2958
[2024-09-06 13:10:48 Info] Client id 2, Epoch 1, train set, Iter 1500 current average loss 2.2956
[2024-09-06 13:11:04 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-06 13:11:07 Info] Stats for test [map] set of size 10000, loss is 2.1689, acc is 23.99%
[2024-09-06 13:11:07 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-06 13:11:09 Info] Stats for test [map] set of size 10000, loss is 2.4095, acc is 7.92%
[2024-09-06 13:11:09 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-06 13:11:12 Info] Stats for test [map] set of size 10000, loss is 2.3752, acc is 15.8%
[2024-09-06 13:11:12 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-06 13:11:14 Info] Stats for test [map] set of size 10000, loss is 2.3659, acc is 10.2%
[2024-09-06 13:11:14 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-06 13:11:17 Info] Stats for test [map] set of size 10000, loss is 2.3748, acc is 11.66%
[2024-09-06 13:11:17 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 13.914
[2024-09-06 13:11:17 Info] Finished epoch number 1, Took 116 seconds
[2024-09-06 13:11:17 Info] Inference method: {'map'}
[2024-09-06 13:11:17 Info] Number of parameters in the model is 199,210
[2024-09-06 13:11:17 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-06 13:11:17 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
[2024-09-06 13:11:17 Info] Gradient clipping with max_norm being done
[2024-09-06 13:11:17 Info] Training epoch number 1 with dataset number 0
[2024-09-06 13:11:48 Info] Client id 3, Epoch 1, train set, Iter 500 current average loss 2.2989
[2024-09-06 13:12:14 Info] Client id 3, Epoch 1, train set, Iter 1000 current average loss 2.2986
[2024-09-06 13:12:43 Info] Client id 3, Epoch 1, train set, Iter 1500 current average loss 2.3014
[2024-09-06 13:13:00 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-06 13:13:03 Info] Stats for test [map] set of size 10000, loss is 2.1815, acc is 27.27%
[2024-09-06 13:13:03 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-06 13:13:06 Info] Stats for test [map] set of size 10000, loss is 2.411, acc is 7.22%
[2024-09-06 13:13:06 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-06 13:13:08 Info] Stats for test [map] set of size 10000, loss is 2.3783, acc is 15.6%
[2024-09-06 13:13:08 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-06 13:13:11 Info] Stats for test [map] set of size 10000, loss is 2.3661, acc is 10.51%
[2024-09-06 13:13:11 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-06 13:13:14 Info] Stats for test [map] set of size 10000, loss is 2.3807, acc is 10.99%
[2024-09-06 13:13:14 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 14.318
[2024-09-06 13:13:14 Info] Finished epoch number 1, Took 117 seconds
[2024-09-06 13:13:14 Info] Inference method: {'map'}
[2024-09-06 13:13:14 Info] Number of parameters in the model is 199,210
[2024-09-06 13:13:14 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-06 13:13:14 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
[2024-09-06 13:13:14 Info] Gradient clipping with max_norm being done
[2024-09-06 13:13:14 Info] Training epoch number 1 with dataset number 0
[2024-09-06 13:13:50 Info] Client id 4, Epoch 1, train set, Iter 500 current average loss 2.282
[2024-09-06 13:14:22 Info] Client id 4, Epoch 1, train set, Iter 1000 current average loss 2.2782
[2024-09-06 13:14:58 Info] Client id 4, Epoch 1, train set, Iter 1500 current average loss 2.276
[2024-09-06 13:15:16 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-06 13:15:19 Info] Stats for test [map] set of size 10000, loss is 2.1565, acc is 28.62%
[2024-09-06 13:15:19 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-06 13:15:22 Info] Stats for test [map] set of size 10000, loss is 2.4056, acc is 6.64%
[2024-09-06 13:15:22 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-06 13:15:26 Info] Stats for test [map] set of size 10000, loss is 2.3779, acc is 15.32%
[2024-09-06 13:15:26 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-06 13:15:29 Info] Stats for test [map] set of size 10000, loss is 2.3642, acc is 10.28%
[2024-09-06 13:15:29 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-06 13:15:32 Info] Stats for test [map] set of size 10000, loss is 2.3875, acc is 9.89%
[2024-09-06 13:15:32 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 14.15
[2024-09-06 13:15:32 Info] Finished epoch number 1, Took 137 seconds
[2024-09-06 13:15:34 Info] Task wise accuracies after round 1 are [26.64]
[2024-09-06 13:15:34 Info] Client 0 task-wise loss and accuracies are - ([2.171], [26.64])
[2024-09-06 13:15:36 Info] Task wise accuracies after round 1 are [27.73]
[2024-09-06 13:15:36 Info] Client 1 task-wise loss and accuracies are - ([2.142], [27.73])
[2024-09-06 13:15:38 Info] Task wise accuracies after round 1 are [23.99]
[2024-09-06 13:15:38 Info] Client 2 task-wise loss and accuracies are - ([2.169], [23.99])
[2024-09-06 13:15:41 Info] Task wise accuracies after round 1 are [27.27]
[2024-09-06 13:15:41 Info] Client 3 task-wise loss and accuracies are - ([2.181], [27.27])
[2024-09-06 13:15:43 Info] Task wise accuracies after round 1 are [28.62]
[2024-09-06 13:15:43 Info] Client 4 task-wise loss and accuracies are - ([2.156], [28.62])
[2024-09-06 13:15:45 Info] Task wise accuracies after round 1 are [13.76]
[2024-09-06 13:15:45 Info] Value of server model at round 1 is 12.42713451385498
[2024-09-06 13:15:45 Info] Aggregated model avg acc and avg loss - (13.76, 2.331)
[2024-09-06 13:15:45 Info] Round - 1 complete
[2024-09-06 13:15:45 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
[2024-09-06 13:15:45 Info] Gradient clipping with max_norm being done
[2024-09-06 13:15:45 Info] Training epoch number 2 with dataset number 0
[2024-09-06 13:16:24 Info] Client id 0, Epoch 2, train set, Iter 500 current average loss 2.1267
[2024-09-06 13:16:59 Info] Client id 0, Epoch 2, train set, Iter 1000 current average loss 2.1292
[2024-09-06 13:17:38 Info] Client id 0, Epoch 2, train set, Iter 1500 current average loss 2.1291
[2024-09-06 13:17:59 Info] Running test set for epoch number 2 for dataset idx 0 using map
[2024-09-06 13:18:03 Info] Stats for test [map] set of size 10000, loss is 1.977, acc is 32.72%
[2024-09-06 13:18:03 Info] Running test set for epoch number 2 for dataset idx 1 using map
[2024-09-06 13:18:06 Info] Stats for test [map] set of size 10000, loss is 2.4044, acc is 4.51%
[2024-09-06 13:18:06 Info] Running test set for epoch number 2 for dataset idx 2 using map
[2024-09-06 13:18:10 Info] Stats for test [map] set of size 10000, loss is 2.3771, acc is 14.21%
[2024-09-06 13:18:10 Info] Running test set for epoch number 2 for dataset idx 3 using map
[2024-09-06 13:18:13 Info] Stats for test [map] set of size 10000, loss is 2.3442, acc is 12.58%
[2024-09-06 13:18:13 Info] Running test set for epoch number 2 for dataset idx 4 using map
[2024-09-06 13:18:17 Info] Stats for test [map] set of size 10000, loss is 2.3717, acc is 12.11%
[2024-09-06 13:18:17 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 4 using map is 15.226
[2024-09-06 13:18:17 Info] Finished epoch number 2, Took 151 seconds
[2024-09-06 13:18:17 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
[2024-09-06 13:18:17 Info] Gradient clipping with max_norm being done
[2024-09-06 13:18:17 Info] Training epoch number 2 with dataset number 0
[2024-09-06 13:19:01 Info] Client id 1, Epoch 2, train set, Iter 500 current average loss 2.1441
[2024-09-06 13:19:46 Info] Client id 1, Epoch 2, train set, Iter 1000 current average loss 2.1415
[2024-09-06 13:20:36 Info] Client id 1, Epoch 2, train set, Iter 1500 current average loss 2.1396
