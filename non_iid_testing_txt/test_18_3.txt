running with abalation!! Are you sure?
[2024-09-07 22:02:09 Info] Script args: Namespace(dataset='ds_cont_permuted_mnist', nn_arch='mnist_simple_net_200width_domainlearning_784input_10cls_1ds', logname='continous_permuted_mnist_5_tasks', results_dir='ds_cont_permuted_mnist_5_tasks_50_epochs_alpha_0.01_data_type_non_iid_3.0_mean_eta__bgd_new_update_optim_4_beta_with_grad_clip_03:32_08-09-2024', seed=1000, num_workers=8, num_epochs=50, batch_size=128, pruning_percents=[], train_mc_iters=10, std_init=0.05, mean_eta=3.0, permanent_prune_on_epoch=-1, permanent_prune_on_epoch_percent=90, momentum=0.9, lr=0.01, weight_decay=0.0005, test_freq=1, contpermuted_beta=4, optimizer='bgd_new_update', optimizer_params='{}', inference_mc=False, inference_map=True, inference_committee=False, inference_aggsoftmax=False, inference_initstd=False, committee_size=0, test_mc_iters=0, init_params=['{"bias_type":', '"xavier",', '"conv_type":', '"xavier",', '"bn_init":', '"01"}'], desc='', bw_to_rgb=False, permuted_offset=False, labels_trick=False, num_of_permutations=4, iterations_per_virtual_epc=67, separate_labels_space=False, permute_seed=2019, federated_learning=True, n_clients=5, num_aggs_per_task=1, grad_clip=True, max_grad_norm=1.0, non_iid_split=True, alpha=0.01, alpha_mg=0.2)
[2024-09-07 22:02:09 Info] Computer name: test-desktop with pytorch version: 2.2.2
Dataset is  ds_cont_permuted_mnist
[2024-09-07 22:02:09 Info] Arguments are Namespace(dataset='ds_cont_permuted_mnist', nn_arch='mnist_simple_net_200width_domainlearning_784input_10cls_1ds', logname='continous_permuted_mnist_5_tasks', results_dir='ds_cont_permuted_mnist_5_tasks_50_epochs_alpha_0.01_data_type_non_iid_3.0_mean_eta__bgd_new_update_optim_4_beta_with_grad_clip_03:32_08-09-2024', seed=1000, num_workers=8, num_epochs=50, batch_size=128, pruning_percents=[], train_mc_iters=10, std_init=0.05, mean_eta=3.0, permanent_prune_on_epoch=-1, permanent_prune_on_epoch_percent=90, momentum=0.9, lr=0.01, weight_decay=0.0005, test_freq=1, contpermuted_beta=4, optimizer='bgd_new_update', optimizer_params='{}', inference_mc=False, inference_map=True, inference_committee=False, inference_aggsoftmax=False, inference_initstd=False, committee_size=0, test_mc_iters=0, init_params=['{"bias_type":', '"xavier",', '"conv_type":', '"xavier",', '"bn_init":', '"01"}'], desc='', bw_to_rgb=False, permuted_offset=False, labels_trick=False, num_of_permutations=4, iterations_per_virtual_epc=67, separate_labels_space=False, permute_seed=2019, federated_learning=True, n_clients=5, num_aggs_per_task=1, grad_clip=True, max_grad_norm=1.0, non_iid_split=True, alpha=0.01, alpha_mg=0.2)
Took 7.000000000000001% of the P-MNSIT dataset
Took 7.000000000000001% of the P-MNSIT dataset
Took 7.000000000000001% of the P-MNSIT dataset
Took 7.000000000000001% of the P-MNSIT dataset
Took 7.000000000000001% of the P-MNSIT dataset
round_end_iters list [ 837 1507 2177 2847 3350]
[ 837 1507 2177 2847 3350]
5
Client Indices Generation starts
Non-IID split is happening and alpha is 0.01
Non-IID split is happening and alpha is 0.01
Non-IID split is happening and alpha is 0.01
Non-IID split is happening and alpha is 0.01
Non-IID split is happening and alpha is 0.01
Clients Indices Generation ends
Client Indices Generation took 7.529505729675293 seconds
1
[2024-09-07 22:02:17 Info] Transformed model to CUDA
[2024-09-07 22:02:17 Info] Initialized 0 Conv2d layers using nn.init.xavier_normal_
[2024-09-07 22:02:17 Info] Initialized 3 linear layers using xavier
[2024-09-07 22:02:17 Info] Initialized 0 bias conv2d layers using nn.init.xavier.noraml_
[2024-09-07 22:02:17 Info] Initialized 3 bias linear layers using xavier
[2024-09-07 22:02:17 Info] Initialized 0 BN layers using weight=1 and bias=0
[2024-09-07 22:02:17 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
0
[2024-09-07 22:02:17 Info] Inference method: {'map'}
[2024-09-07 22:02:17 Info] Number of parameters in the model is 199,210
[2024-09-07 22:02:17 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-07 22:02:17 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:02:17 Info] Gradient clipping with max_norm being done
Model id is  139706001536816
Model value at client 1 is -0.9189211130142212 in round 1
[2024-09-07 22:02:17 Info] Training epoch number 1 with dataset number 0
[2024-09-07 22:02:31 Info] Client id 0, Epoch 1, train set, Iter 500 current average loss 1.238
[2024-09-07 22:02:40 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-07 22:02:40 Info] Stats for test [map] set of size 10000, loss is 2.6769, acc is 9.9%
[2024-09-07 22:02:40 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-07 22:02:41 Info] Stats for test [map] set of size 10000, loss is 2.87, acc is 14.85%
[2024-09-07 22:02:41 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-07 22:02:42 Info] Stats for test [map] set of size 10000, loss is 2.7805, acc is 10.1%
[2024-09-07 22:02:42 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-07 22:02:42 Info] Stats for test [map] set of size 10000, loss is 2.7134, acc is 10.1%
[2024-09-07 22:02:42 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-07 22:02:43 Info] Stats for test [map] set of size 10000, loss is 2.7352, acc is 10.1%
[2024-09-07 22:02:43 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 11.01
[2024-09-07 22:02:43 Info] Finished epoch number 1, Took 25 seconds
Round - 1,Client - 1
837, 0, 837
[2024-09-07 22:02:43 Info] Inference method: {'map'}
[2024-09-07 22:02:43 Info] Number of parameters in the model is 199,210
[2024-09-07 22:02:43 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-07 22:02:43 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:02:43 Info] Gradient clipping with max_norm being done
Model id is  139707728066976
Model value at client 2 is -0.9189211130142212 in round 1
[2024-09-07 22:02:43 Info] Training epoch number 1 with dataset number 0
[2024-09-07 22:02:56 Info] Client id 1, Epoch 1, train set, Iter 500 current average loss 1.1487
[2024-09-07 22:03:05 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-07 22:03:05 Info] Stats for test [map] set of size 10000, loss is 2.6706, acc is 9.61%
[2024-09-07 22:03:05 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-07 22:03:06 Info] Stats for test [map] set of size 10000, loss is 5.2757, acc is 9.58%
[2024-09-07 22:03:06 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-07 22:03:06 Info] Stats for test [map] set of size 10000, loss is 3.0687, acc is 9.58%
[2024-09-07 22:03:06 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-07 22:03:07 Info] Stats for test [map] set of size 10000, loss is 3.1955, acc is 9.58%
[2024-09-07 22:03:07 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-07 22:03:08 Info] Stats for test [map] set of size 10000, loss is 2.9857, acc is 9.58%
[2024-09-07 22:03:08 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 9.586
[2024-09-07 22:03:08 Info] Finished epoch number 1, Took 25 seconds
Round - 1,Client - 2
837, 0, 837
[2024-09-07 22:03:08 Info] Inference method: {'map'}
[2024-09-07 22:03:08 Info] Number of parameters in the model is 199,210
[2024-09-07 22:03:08 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-07 22:03:08 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:03:08 Info] Gradient clipping with max_norm being done
Model id is  139705897085984
Model value at client 3 is -0.9189211130142212 in round 1
[2024-09-07 22:03:08 Info] Training epoch number 1 with dataset number 0
[2024-09-07 22:03:21 Info] Client id 2, Epoch 1, train set, Iter 500 current average loss 0.8863
[2024-09-07 22:03:29 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-07 22:03:29 Info] Stats for test [map] set of size 10000, loss is 2.4422, acc is 11.17%
[2024-09-07 22:03:29 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-07 22:03:30 Info] Stats for test [map] set of size 10000, loss is 2.4377, acc is 21.36%
[2024-09-07 22:03:30 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-07 22:03:31 Info] Stats for test [map] set of size 10000, loss is 2.5624, acc is 11.05%
[2024-09-07 22:03:31 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-07 22:03:31 Info] Stats for test [map] set of size 10000, loss is 2.5802, acc is 11.56%
[2024-09-07 22:03:31 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-07 22:03:32 Info] Stats for test [map] set of size 10000, loss is 2.5578, acc is 10.76%
[2024-09-07 22:03:32 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 13.18
[2024-09-07 22:03:32 Info] Finished epoch number 1, Took 24 seconds
Round - 1,Client - 3
837, 0, 837
[2024-09-07 22:03:32 Info] Inference method: {'map'}
[2024-09-07 22:03:32 Info] Number of parameters in the model is 199,210
[2024-09-07 22:03:32 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-07 22:03:32 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:03:32 Info] Gradient clipping with max_norm being done
Model id is  139705895851952
Model value at client 4 is -0.9189211130142212 in round 1
[2024-09-07 22:03:32 Info] Training epoch number 1 with dataset number 0
[2024-09-07 22:03:45 Info] Client id 3, Epoch 1, train set, Iter 500 current average loss 1.0522
[2024-09-07 22:03:54 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-07 22:03:55 Info] Stats for test [map] set of size 10000, loss is 2.8463, acc is 10.32%
[2024-09-07 22:03:55 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-07 22:03:55 Info] Stats for test [map] set of size 10000, loss is 2.8834, acc is 12.44%
[2024-09-07 22:03:55 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-07 22:03:56 Info] Stats for test [map] set of size 10000, loss is 2.9659, acc is 10.32%
[2024-09-07 22:03:56 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-07 22:03:57 Info] Stats for test [map] set of size 10000, loss is 2.9532, acc is 10.32%
[2024-09-07 22:03:57 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-07 22:03:57 Info] Stats for test [map] set of size 10000, loss is 2.9438, acc is 10.32%
[2024-09-07 22:03:57 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 10.744
[2024-09-07 22:03:57 Info] Finished epoch number 1, Took 25 seconds
Round - 1,Client - 4
837, 0, 837
[2024-09-07 22:03:57 Info] Inference method: {'map'}
[2024-09-07 22:03:57 Info] Number of parameters in the model is 199,210
[2024-09-07 22:03:57 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-07 22:03:57 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:03:57 Info] Gradient clipping with max_norm being done
Model id is  139705895850320
Model value at client 5 is -0.9189211130142212 in round 1
[2024-09-07 22:03:57 Info] Training epoch number 1 with dataset number 0
[2024-09-07 22:04:12 Info] Client id 4, Epoch 1, train set, Iter 500 current average loss 0.8132
[2024-09-07 22:04:21 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-07 22:04:22 Info] Stats for test [map] set of size 10000, loss is 2.6911, acc is 10.29%
[2024-09-07 22:04:22 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-07 22:04:22 Info] Stats for test [map] set of size 10000, loss is 3.1977, acc is 18.1%
[2024-09-07 22:04:22 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-07 22:04:23 Info] Stats for test [map] set of size 10000, loss is 2.9463, acc is 10.28%
[2024-09-07 22:04:23 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-07 22:04:24 Info] Stats for test [map] set of size 10000, loss is 2.7754, acc is 10.68%
[2024-09-07 22:04:24 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-07 22:04:24 Info] Stats for test [map] set of size 10000, loss is 2.9445, acc is 10.28%
[2024-09-07 22:04:24 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 11.926
[2024-09-07 22:04:24 Info] Finished epoch number 1, Took 26 seconds
Round - 1,Client - 5
837, 0, 837
[2024-09-07 22:04:25 Info] Task wise accuracies after round 1 are [9.9]
[2024-09-07 22:04:25 Info] Client 0 task-wise loss and accuracies are - ([2.677], [9.9])
[2024-09-07 22:04:25 Info] Task wise accuracies after round 1 are [9.61]
[2024-09-07 22:04:25 Info] Client 1 task-wise loss and accuracies are - ([2.67], [9.61])
[2024-09-07 22:04:25 Info] Task wise accuracies after round 1 are [11.17]
[2024-09-07 22:04:25 Info] Client 2 task-wise loss and accuracies are - ([2.443], [11.17])
[2024-09-07 22:04:26 Info] Task wise accuracies after round 1 are [10.32]
[2024-09-07 22:04:26 Info] Client 3 task-wise loss and accuracies are - ([2.847], [10.32])
[2024-09-07 22:04:26 Info] Task wise accuracies after round 1 are [10.29]
[2024-09-07 22:04:26 Info] Client 4 task-wise loss and accuracies are - ([2.693], [10.29])
[2024-09-07 22:04:27 Info] Task wise accuracies after round 1 are [5.94]
[2024-09-07 22:04:27 Info] Value of server model at round 1 is 18.36238670349121
[2024-09-07 22:04:27 Info] Aggregated model avg acc and avg loss - (5.94, 2.48)
[2024-09-07 22:04:27 Info] Round - 1 complete
1
[2024-09-07 22:04:27 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:04:27 Info] Gradient clipping with max_norm being done
Model id is  139705895854064
Model value at client 1 is 18.36238670349121 in round 2
[2024-09-07 22:04:27 Info] Training epoch number 2 with dataset number 0
[2024-09-07 22:04:41 Info] Client id 0, Epoch 2, train set, Iter 500 current average loss 1.3593
[2024-09-07 22:04:46 Info] Running test set for epoch number 2 for dataset idx 0 using map
[2024-09-07 22:04:46 Info] Stats for test [map] set of size 10000, loss is 2.5788, acc is 11.42%
[2024-09-07 22:04:46 Info] Running test set for epoch number 2 for dataset idx 1 using map
[2024-09-07 22:04:47 Info] Stats for test [map] set of size 10000, loss is 2.4789, acc is 11.35%
[2024-09-07 22:04:47 Info] Running test set for epoch number 2 for dataset idx 2 using map
[2024-09-07 22:04:48 Info] Stats for test [map] set of size 10000, loss is 2.6781, acc is 13.25%
[2024-09-07 22:04:48 Info] Running test set for epoch number 2 for dataset idx 3 using map
[2024-09-07 22:04:48 Info] Stats for test [map] set of size 10000, loss is 2.628, acc is 11.35%
[2024-09-07 22:04:48 Info] Running test set for epoch number 2 for dataset idx 4 using map
[2024-09-07 22:04:49 Info] Stats for test [map] set of size 10000, loss is 2.6339, acc is 11.35%
[2024-09-07 22:04:49 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 4 using map is 11.744
[2024-09-07 22:04:49 Info] Finished epoch number 2, Took 21 seconds
Round - 2,Client - 1
1507, 837, 1507
[2024-09-07 22:04:49 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:04:49 Info] Gradient clipping with max_norm being done
Model id is  139705897086464
Model value at client 2 is 18.36238670349121 in round 2
[2024-09-07 22:04:49 Info] Training epoch number 2 with dataset number 0
[2024-09-07 22:05:03 Info] Client id 1, Epoch 2, train set, Iter 500 current average loss 0.1242
[2024-09-07 22:05:07 Info] Running test set for epoch number 2 for dataset idx 0 using map
[2024-09-07 22:05:08 Info] Stats for test [map] set of size 10000, loss is 2.6568, acc is 10.32%
[2024-09-07 22:05:08 Info] Running test set for epoch number 2 for dataset idx 1 using map
[2024-09-07 22:05:08 Info] Stats for test [map] set of size 10000, loss is 2.4481, acc is 10.32%
[2024-09-07 22:05:08 Info] Running test set for epoch number 2 for dataset idx 2 using map
[2024-09-07 22:05:09 Info] Stats for test [map] set of size 10000, loss is 2.6799, acc is 10.35%
[2024-09-07 22:05:09 Info] Running test set for epoch number 2 for dataset idx 3 using map
[2024-09-07 22:05:10 Info] Stats for test [map] set of size 10000, loss is 2.6737, acc is 10.32%
[2024-09-07 22:05:10 Info] Running test set for epoch number 2 for dataset idx 4 using map
[2024-09-07 22:05:10 Info] Stats for test [map] set of size 10000, loss is 2.6832, acc is 10.32%
[2024-09-07 22:05:10 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 4 using map is 10.326
[2024-09-07 22:05:10 Info] Finished epoch number 2, Took 21 seconds
Round - 2,Client - 2
1507, 837, 1507
[2024-09-07 22:05:10 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:05:10 Info] Gradient clipping with max_norm being done
Model id is  139707728067600
Model value at client 3 is 18.36238670349121 in round 2
[2024-09-07 22:05:10 Info] Training epoch number 2 with dataset number 0
[2024-09-07 22:05:25 Info] Client id 2, Epoch 2, train set, Iter 500 current average loss 1.0958
[2024-09-07 22:05:29 Info] Running test set for epoch number 2 for dataset idx 0 using map
[2024-09-07 22:05:30 Info] Stats for test [map] set of size 10000, loss is 2.5495, acc is 9.77%
[2024-09-07 22:05:30 Info] Running test set for epoch number 2 for dataset idx 1 using map
[2024-09-07 22:05:31 Info] Stats for test [map] set of size 10000, loss is 2.5127, acc is 10.06%
[2024-09-07 22:05:31 Info] Running test set for epoch number 2 for dataset idx 2 using map
[2024-09-07 22:05:31 Info] Stats for test [map] set of size 10000, loss is 3.6243, acc is 14.41%
[2024-09-07 22:05:31 Info] Running test set for epoch number 2 for dataset idx 3 using map
[2024-09-07 22:05:32 Info] Stats for test [map] set of size 10000, loss is 2.5448, acc is 10.18%
[2024-09-07 22:05:32 Info] Running test set for epoch number 2 for dataset idx 4 using map
[2024-09-07 22:05:33 Info] Stats for test [map] set of size 10000, loss is 2.6475, acc is 10.09%
[2024-09-07 22:05:33 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 4 using map is 10.902
[2024-09-07 22:05:33 Info] Finished epoch number 2, Took 22 seconds
Round - 2,Client - 3
1507, 837, 1507
[2024-09-07 22:05:33 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:05:33 Info] Gradient clipping with max_norm being done
Model id is  139705897085984
Model value at client 4 is 18.36238670349121 in round 2
[2024-09-07 22:05:33 Info] Training epoch number 2 with dataset number 0
[2024-09-07 22:05:47 Info] Client id 3, Epoch 2, train set, Iter 500 current average loss 1.0281
[2024-09-07 22:05:51 Info] Running test set for epoch number 2 for dataset idx 0 using map
[2024-09-07 22:05:51 Info] Stats for test [map] set of size 10000, loss is 3.0465, acc is 8.92%
[2024-09-07 22:05:51 Info] Running test set for epoch number 2 for dataset idx 1 using map
[2024-09-07 22:05:52 Info] Stats for test [map] set of size 10000, loss is 2.6407, acc is 8.92%
[2024-09-07 22:05:52 Info] Running test set for epoch number 2 for dataset idx 2 using map
[2024-09-07 22:05:53 Info] Stats for test [map] set of size 10000, loss is 3.6555, acc is 11.39%
[2024-09-07 22:05:53 Info] Running test set for epoch number 2 for dataset idx 3 using map
[2024-09-07 22:05:53 Info] Stats for test [map] set of size 10000, loss is 2.9991, acc is 8.92%
[2024-09-07 22:05:53 Info] Running test set for epoch number 2 for dataset idx 4 using map
[2024-09-07 22:05:54 Info] Stats for test [map] set of size 10000, loss is 2.9211, acc is 8.92%
[2024-09-07 22:05:54 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 4 using map is 9.414
[2024-09-07 22:05:54 Info] Finished epoch number 2, Took 21 seconds
Round - 2,Client - 4
1507, 837, 1507
[2024-09-07 22:05:54 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:05:54 Info] Gradient clipping with max_norm being done
Model id is  139706001538112
Model value at client 5 is 18.36238670349121 in round 2
[2024-09-07 22:05:54 Info] Training epoch number 2 with dataset number 0
[2024-09-07 22:06:08 Info] Client id 4, Epoch 2, train set, Iter 500 current average loss 1.1165
[2024-09-07 22:06:12 Info] Running test set for epoch number 2 for dataset idx 0 using map
[2024-09-07 22:06:12 Info] Stats for test [map] set of size 10000, loss is 2.6625, acc is 9.8%
[2024-09-07 22:06:12 Info] Running test set for epoch number 2 for dataset idx 1 using map
[2024-09-07 22:06:13 Info] Stats for test [map] set of size 10000, loss is 2.4961, acc is 11.11%
[2024-09-07 22:06:13 Info] Running test set for epoch number 2 for dataset idx 2 using map
[2024-09-07 22:06:14 Info] Stats for test [map] set of size 10000, loss is 2.6956, acc is 18.88%
[2024-09-07 22:06:14 Info] Running test set for epoch number 2 for dataset idx 3 using map
[2024-09-07 22:06:14 Info] Stats for test [map] set of size 10000, loss is 2.7927, acc is 9.8%
[2024-09-07 22:06:14 Info] Running test set for epoch number 2 for dataset idx 4 using map
[2024-09-07 22:06:15 Info] Stats for test [map] set of size 10000, loss is 2.6376, acc is 9.83%
[2024-09-07 22:06:15 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 4 using map is 11.884
[2024-09-07 22:06:15 Info] Finished epoch number 2, Took 21 seconds
Round - 2,Client - 5
1507, 837, 1507
[2024-09-07 22:06:16 Info] Task wise accuracies after round 2 are [11.42, 11.35]
[2024-09-07 22:06:16 Info] Client 0 task-wise loss and accuracies are - ([2.58, 2.479], [11.42, 11.35])
[2024-09-07 22:06:17 Info] Task wise accuracies after round 2 are [10.32, 10.32]
[2024-09-07 22:06:17 Info] Client 1 task-wise loss and accuracies are - ([2.657, 2.447], [10.32, 10.32])
[2024-09-07 22:06:18 Info] Task wise accuracies after round 2 are [9.77, 10.06]
[2024-09-07 22:06:18 Info] Client 2 task-wise loss and accuracies are - ([2.55, 2.513], [9.77, 10.06])
[2024-09-07 22:06:19 Info] Task wise accuracies after round 2 are [8.92, 8.92]
[2024-09-07 22:06:19 Info] Client 3 task-wise loss and accuracies are - ([3.047, 2.639], [8.92, 8.92])
[2024-09-07 22:06:20 Info] Task wise accuracies after round 2 are [9.8, 11.11]
[2024-09-07 22:06:20 Info] Client 4 task-wise loss and accuracies are - ([2.664, 2.497], [9.8, 11.11])
[2024-09-07 22:06:22 Info] Task wise accuracies after round 2 are [9.41, 13.33]
[2024-09-07 22:06:22 Info] Value of server model at round 2 is -46.730926513671875
[2024-09-07 22:06:22 Info] Aggregated model avg acc and avg loss - (11.37, 2.347)
[2024-09-07 22:06:22 Info] Round - 2 complete
2
[2024-09-07 22:06:22 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:06:22 Info] Gradient clipping with max_norm being done
Model id is  139705897089488
Model value at client 1 is -46.730926513671875 in round 3
[2024-09-07 22:06:22 Info] Training epoch number 3 with dataset number 0
[2024-09-07 22:06:35 Info] Client id 0, Epoch 3, train set, Iter 500 current average loss 1.2841
[2024-09-07 22:06:40 Info] Running test set for epoch number 3 for dataset idx 0 using map
[2024-09-07 22:06:41 Info] Stats for test [map] set of size 10000, loss is 3.3558, acc is 10.09%
[2024-09-07 22:06:41 Info] Running test set for epoch number 3 for dataset idx 1 using map
[2024-09-07 22:06:41 Info] Stats for test [map] set of size 10000, loss is 3.558, acc is 10.09%
[2024-09-07 22:06:41 Info] Running test set for epoch number 3 for dataset idx 2 using map
[2024-09-07 22:06:42 Info] Stats for test [map] set of size 10000, loss is 3.3894, acc is 10.09%
[2024-09-07 22:06:42 Info] Running test set for epoch number 3 for dataset idx 3 using map
[2024-09-07 22:06:43 Info] Stats for test [map] set of size 10000, loss is 4.7306, acc is 10.09%
[2024-09-07 22:06:43 Info] Running test set for epoch number 3 for dataset idx 4 using map
[2024-09-07 22:06:43 Info] Stats for test [map] set of size 10000, loss is 3.843, acc is 10.09%
[2024-09-07 22:06:43 Info] Average accuracy over all tasks for epoch number 3 for dataset idx 4 using map is 10.09
[2024-09-07 22:06:43 Info] Finished epoch number 3, Took 21 seconds
Round - 3,Client - 1
2177, 1507, 2177
[2024-09-07 22:06:43 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:06:43 Info] Gradient clipping with max_norm being done
Model id is  139706001530576
Model value at client 2 is -46.730926513671875 in round 3
[2024-09-07 22:06:43 Info] Training epoch number 3 with dataset number 0
[2024-09-07 22:06:58 Info] Client id 1, Epoch 3, train set, Iter 500 current average loss 1.3852
[2024-09-07 22:07:03 Info] Running test set for epoch number 3 for dataset idx 0 using map
[2024-09-07 22:07:04 Info] Stats for test [map] set of size 10000, loss is 3.6464, acc is 10.32%
[2024-09-07 22:07:04 Info] Running test set for epoch number 3 for dataset idx 1 using map
[2024-09-07 22:07:05 Info] Stats for test [map] set of size 10000, loss is 3.3678, acc is 10.32%
[2024-09-07 22:07:05 Info] Running test set for epoch number 3 for dataset idx 2 using map
[2024-09-07 22:07:06 Info] Stats for test [map] set of size 10000, loss is 3.2716, acc is 10.32%
[2024-09-07 22:07:06 Info] Running test set for epoch number 3 for dataset idx 3 using map
[2024-09-07 22:07:06 Info] Stats for test [map] set of size 10000, loss is 4.3656, acc is 11.9%
[2024-09-07 22:07:06 Info] Running test set for epoch number 3 for dataset idx 4 using map
[2024-09-07 22:07:07 Info] Stats for test [map] set of size 10000, loss is 3.6294, acc is 10.32%
[2024-09-07 22:07:07 Info] Average accuracy over all tasks for epoch number 3 for dataset idx 4 using map is 10.636
[2024-09-07 22:07:07 Info] Finished epoch number 3, Took 23 seconds
Round - 3,Client - 2
2177, 1507, 2177
[2024-09-07 22:07:07 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:07:07 Info] Gradient clipping with max_norm being done
Model id is  139706002435200
Model value at client 3 is -46.730926513671875 in round 3
[2024-09-07 22:07:07 Info] Training epoch number 3 with dataset number 0
[2024-09-07 22:07:22 Info] Client id 2, Epoch 3, train set, Iter 500 current average loss 0.8052
[2024-09-07 22:07:27 Info] Running test set for epoch number 3 for dataset idx 0 using map
[2024-09-07 22:07:28 Info] Stats for test [map] set of size 10000, loss is 3.7902, acc is 8.92%
[2024-09-07 22:07:28 Info] Running test set for epoch number 3 for dataset idx 1 using map
[2024-09-07 22:07:29 Info] Stats for test [map] set of size 10000, loss is 3.5663, acc is 8.92%
[2024-09-07 22:07:29 Info] Running test set for epoch number 3 for dataset idx 2 using map
[2024-09-07 22:07:29 Info] Stats for test [map] set of size 10000, loss is 3.5623, acc is 8.92%
[2024-09-07 22:07:29 Info] Running test set for epoch number 3 for dataset idx 3 using map
[2024-09-07 22:07:30 Info] Stats for test [map] set of size 10000, loss is 3.9652, acc is 8.92%
[2024-09-07 22:07:30 Info] Running test set for epoch number 3 for dataset idx 4 using map
[2024-09-07 22:07:31 Info] Stats for test [map] set of size 10000, loss is 3.7272, acc is 8.92%
[2024-09-07 22:07:31 Info] Average accuracy over all tasks for epoch number 3 for dataset idx 4 using map is 8.92
[2024-09-07 22:07:31 Info] Finished epoch number 3, Took 23 seconds
Round - 3,Client - 3
2177, 1507, 2177
[2024-09-07 22:07:31 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:07:31 Info] Gradient clipping with max_norm being done
Model id is  139706039962640
Model value at client 4 is -46.730926513671875 in round 3
[2024-09-07 22:07:31 Info] Training epoch number 3 with dataset number 0
[2024-09-07 22:07:46 Info] Client id 3, Epoch 3, train set, Iter 500 current average loss 1.1475
[2024-09-07 22:07:51 Info] Running test set for epoch number 3 for dataset idx 0 using map
[2024-09-07 22:07:51 Info] Stats for test [map] set of size 10000, loss is 3.8779, acc is 11.35%
[2024-09-07 22:07:51 Info] Running test set for epoch number 3 for dataset idx 1 using map
[2024-09-07 22:07:52 Info] Stats for test [map] set of size 10000, loss is 4.2059, acc is 11.35%
[2024-09-07 22:07:52 Info] Running test set for epoch number 3 for dataset idx 2 using map
[2024-09-07 22:07:52 Info] Stats for test [map] set of size 10000, loss is 3.7599, acc is 11.35%
[2024-09-07 22:07:52 Info] Running test set for epoch number 3 for dataset idx 3 using map
[2024-09-07 22:07:53 Info] Stats for test [map] set of size 10000, loss is 4.9648, acc is 17.97%
[2024-09-07 22:07:53 Info] Running test set for epoch number 3 for dataset idx 4 using map
[2024-09-07 22:07:54 Info] Stats for test [map] set of size 10000, loss is 3.9428, acc is 11.35%
[2024-09-07 22:07:54 Info] Average accuracy over all tasks for epoch number 3 for dataset idx 4 using map is 12.674
[2024-09-07 22:07:54 Info] Finished epoch number 3, Took 23 seconds
Round - 3,Client - 4
2177, 1507, 2177
[2024-09-07 22:07:54 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:07:54 Info] Gradient clipping with max_norm being done
Model id is  139706001531200
Model value at client 5 is -46.730926513671875 in round 3
[2024-09-07 22:07:54 Info] Training epoch number 3 with dataset number 0
[2024-09-07 22:08:10 Info] Client id 4, Epoch 3, train set, Iter 500 current average loss 0.7366
[2024-09-07 22:08:15 Info] Running test set for epoch number 3 for dataset idx 0 using map
[2024-09-07 22:08:16 Info] Stats for test [map] set of size 10000, loss is 2.6146, acc is 9.82%
[2024-09-07 22:08:16 Info] Running test set for epoch number 3 for dataset idx 1 using map
[2024-09-07 22:08:16 Info] Stats for test [map] set of size 10000, loss is 2.5308, acc is 9.83%
[2024-09-07 22:08:16 Info] Running test set for epoch number 3 for dataset idx 2 using map
[2024-09-07 22:08:17 Info] Stats for test [map] set of size 10000, loss is 2.5543, acc is 9.82%
[2024-09-07 22:08:17 Info] Running test set for epoch number 3 for dataset idx 3 using map
[2024-09-07 22:08:18 Info] Stats for test [map] set of size 10000, loss is 3.3135, acc is 16.66%
[2024-09-07 22:08:18 Info] Running test set for epoch number 3 for dataset idx 4 using map
[2024-09-07 22:08:18 Info] Stats for test [map] set of size 10000, loss is 2.8953, acc is 9.82%
[2024-09-07 22:08:18 Info] Average accuracy over all tasks for epoch number 3 for dataset idx 4 using map is 11.19
[2024-09-07 22:08:18 Info] Finished epoch number 3, Took 24 seconds
Round - 3,Client - 5
2177, 1507, 2177
[2024-09-07 22:08:20 Info] Task wise accuracies after round 3 are [10.09, 10.09, 10.09]
[2024-09-07 22:08:20 Info] Client 0 task-wise loss and accuracies are - ([3.359, 3.562, 3.392], [10.09, 10.09, 10.09])
[2024-09-07 22:08:22 Info] Task wise accuracies after round 3 are [10.32, 10.32, 10.32]
[2024-09-07 22:08:22 Info] Client 1 task-wise loss and accuracies are - ([3.648, 3.368, 3.272], [10.32, 10.32, 10.32])
[2024-09-07 22:08:24 Info] Task wise accuracies after round 3 are [8.92, 8.92, 8.92]
[2024-09-07 22:08:24 Info] Client 2 task-wise loss and accuracies are - ([3.79, 3.564, 3.561], [8.92, 8.92, 8.92])
[2024-09-07 22:08:26 Info] Task wise accuracies after round 3 are [11.35, 11.35, 11.35]
[2024-09-07 22:08:26 Info] Client 3 task-wise loss and accuracies are - ([3.88, 4.207, 3.761], [11.35, 11.35, 11.35])
[2024-09-07 22:08:28 Info] Task wise accuracies after round 3 are [9.82, 9.83, 9.82]
[2024-09-07 22:08:28 Info] Client 4 task-wise loss and accuracies are - ([2.614, 2.531, 2.555], [9.82, 9.83, 9.82])
[2024-09-07 22:08:30 Info] Task wise accuracies after round 3 are [8.2, 8.93, 18.89]
[2024-09-07 22:08:30 Info] Value of server model at round 3 is -59.219581604003906
[2024-09-07 22:08:30 Info] Aggregated model avg acc and avg loss - (12.007, 2.383)
[2024-09-07 22:08:30 Info] Round - 3 complete
3
[2024-09-07 22:08:30 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:08:30 Info] Gradient clipping with max_norm being done
Model id is  139707728025760
Model value at client 1 is -59.219581604003906 in round 4
[2024-09-07 22:08:30 Info] Training epoch number 4 with dataset number 0
[2024-09-07 22:08:45 Info] Client id 0, Epoch 4, train set, Iter 500 current average loss 5.3801
[2024-09-07 22:08:51 Info] Running test set for epoch number 4 for dataset idx 0 using map
[2024-09-07 22:08:51 Info] Stats for test [map] set of size 10000, loss is 2.5199, acc is 10.35%
[2024-09-07 22:08:51 Info] Running test set for epoch number 4 for dataset idx 1 using map
[2024-09-07 22:08:52 Info] Stats for test [map] set of size 10000, loss is 2.4985, acc is 19.17%
[2024-09-07 22:08:52 Info] Running test set for epoch number 4 for dataset idx 2 using map
[2024-09-07 22:08:52 Info] Stats for test [map] set of size 10000, loss is 2.3101, acc is 14.98%
[2024-09-07 22:08:52 Info] Running test set for epoch number 4 for dataset idx 3 using map
[2024-09-07 22:08:53 Info] Stats for test [map] set of size 10000, loss is 2.2157, acc is 26.6%
[2024-09-07 22:08:53 Info] Running test set for epoch number 4 for dataset idx 4 using map
[2024-09-07 22:08:54 Info] Stats for test [map] set of size 10000, loss is 3.8692, acc is 19.99%
[2024-09-07 22:08:54 Info] Average accuracy over all tasks for epoch number 4 for dataset idx 4 using map is 18.218
[2024-09-07 22:08:54 Info] Finished epoch number 4, Took 23 seconds
Round - 4,Client - 1
2847, 2177, 2847
[2024-09-07 22:08:54 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:08:54 Info] Gradient clipping with max_norm being done
Model id is  139706002429536
Model value at client 2 is -59.219581604003906 in round 4
[2024-09-07 22:08:54 Info] Training epoch number 4 with dataset number 0
[2024-09-07 22:09:09 Info] Client id 1, Epoch 4, train set, Iter 500 current average loss 4.4788
[2024-09-07 22:09:14 Info] Running test set for epoch number 4 for dataset idx 0 using map
[2024-09-07 22:09:15 Info] Stats for test [map] set of size 10000, loss is 3.2084, acc is 9.95%
[2024-09-07 22:09:15 Info] Running test set for epoch number 4 for dataset idx 1 using map
[2024-09-07 22:09:15 Info] Stats for test [map] set of size 10000, loss is 3.0178, acc is 16.27%
[2024-09-07 22:09:15 Info] Running test set for epoch number 4 for dataset idx 2 using map
[2024-09-07 22:09:16 Info] Stats for test [map] set of size 10000, loss is 3.0919, acc is 11.62%
[2024-09-07 22:09:16 Info] Running test set for epoch number 4 for dataset idx 3 using map
[2024-09-07 22:09:17 Info] Stats for test [map] set of size 10000, loss is 3.0652, acc is 16.26%
[2024-09-07 22:09:17 Info] Running test set for epoch number 4 for dataset idx 4 using map
[2024-09-07 22:09:18 Info] Stats for test [map] set of size 10000, loss is 5.0607, acc is 18.03%
[2024-09-07 22:09:18 Info] Average accuracy over all tasks for epoch number 4 for dataset idx 4 using map is 14.426
[2024-09-07 22:09:18 Info] Finished epoch number 4, Took 23 seconds
Round - 4,Client - 2
2847, 2177, 2847
[2024-09-07 22:09:18 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:09:18 Info] Gradient clipping with max_norm being done
Model id is  139706002424832
Model value at client 3 is -59.219581604003906 in round 4
[2024-09-07 22:09:18 Info] Training epoch number 4 with dataset number 0
[2024-09-07 22:09:33 Info] Client id 2, Epoch 4, train set, Iter 500 current average loss 18.4833
[2024-09-07 22:09:38 Info] Running test set for epoch number 4 for dataset idx 0 using map
[2024-09-07 22:09:39 Info] Stats for test [map] set of size 10000, loss is 158.2755, acc is 8.92%
[2024-09-07 22:09:39 Info] Running test set for epoch number 4 for dataset idx 1 using map
[2024-09-07 22:09:39 Info] Stats for test [map] set of size 10000, loss is 157.6249, acc is 8.92%
[2024-09-07 22:09:39 Info] Running test set for epoch number 4 for dataset idx 2 using map
[2024-09-07 22:09:40 Info] Stats for test [map] set of size 10000, loss is 158.5068, acc is 8.92%
[2024-09-07 22:09:40 Info] Running test set for epoch number 4 for dataset idx 3 using map
[2024-09-07 22:09:41 Info] Stats for test [map] set of size 10000, loss is 157.4743, acc is 8.92%
[2024-09-07 22:09:41 Info] Running test set for epoch number 4 for dataset idx 4 using map
[2024-09-07 22:09:42 Info] Stats for test [map] set of size 10000, loss is 151.5561, acc is 8.92%
[2024-09-07 22:09:42 Info] Average accuracy over all tasks for epoch number 4 for dataset idx 4 using map is 8.92
[2024-09-07 22:09:42 Info] Finished epoch number 4, Took 24 seconds
Round - 4,Client - 3
2847, 2177, 2847
[2024-09-07 22:09:42 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:09:42 Info] Gradient clipping with max_norm being done
Model id is  139706002436304
Model value at client 4 is -59.219581604003906 in round 4
[2024-09-07 22:09:42 Info] Training epoch number 4 with dataset number 0
[2024-09-07 22:09:57 Info] Client id 3, Epoch 4, train set, Iter 500 current average loss 7.5996
[2024-09-07 22:10:03 Info] Running test set for epoch number 4 for dataset idx 0 using map
[2024-09-07 22:10:03 Info] Stats for test [map] set of size 10000, loss is 3.083, acc is 9.75%
[2024-09-07 22:10:03 Info] Running test set for epoch number 4 for dataset idx 1 using map
[2024-09-07 22:10:04 Info] Stats for test [map] set of size 10000, loss is 2.9431, acc is 17.23%
[2024-09-07 22:10:04 Info] Running test set for epoch number 4 for dataset idx 2 using map
[2024-09-07 22:10:05 Info] Stats for test [map] set of size 10000, loss is 2.9568, acc is 12.21%
[2024-09-07 22:10:05 Info] Running test set for epoch number 4 for dataset idx 3 using map
[2024-09-07 22:10:05 Info] Stats for test [map] set of size 10000, loss is 2.8721, acc is 14.82%
[2024-09-07 22:10:05 Info] Running test set for epoch number 4 for dataset idx 4 using map
[2024-09-07 22:10:06 Info] Stats for test [map] set of size 10000, loss is 3.1368, acc is 19.57%
[2024-09-07 22:10:06 Info] Average accuracy over all tasks for epoch number 4 for dataset idx 4 using map is 14.716
[2024-09-07 22:10:06 Info] Finished epoch number 4, Took 24 seconds
Round - 4,Client - 4
2847, 2177, 2847
[2024-09-07 22:10:06 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:10:06 Info] Gradient clipping with max_norm being done
Model id is  139706002439040
Model value at client 5 is -59.219581604003906 in round 4
[2024-09-07 22:10:06 Info] Training epoch number 4 with dataset number 0
[2024-09-07 22:10:21 Info] Client id 4, Epoch 4, train set, Iter 500 current average loss 0.8208
[2024-09-07 22:10:27 Info] Running test set for epoch number 4 for dataset idx 0 using map
[2024-09-07 22:10:27 Info] Stats for test [map] set of size 10000, loss is 3.2351, acc is 11.32%
[2024-09-07 22:10:27 Info] Running test set for epoch number 4 for dataset idx 1 using map
[2024-09-07 22:10:28 Info] Stats for test [map] set of size 10000, loss is 3.2536, acc is 13.92%
[2024-09-07 22:10:28 Info] Running test set for epoch number 4 for dataset idx 2 using map
[2024-09-07 22:10:29 Info] Stats for test [map] set of size 10000, loss is 3.0858, acc is 17.95%
[2024-09-07 22:10:29 Info] Running test set for epoch number 4 for dataset idx 3 using map
[2024-09-07 22:10:29 Info] Stats for test [map] set of size 10000, loss is 2.995, acc is 14.58%
[2024-09-07 22:10:29 Info] Running test set for epoch number 4 for dataset idx 4 using map
[2024-09-07 22:10:30 Info] Stats for test [map] set of size 10000, loss is 3.3958, acc is 22.7%
[2024-09-07 22:10:30 Info] Average accuracy over all tasks for epoch number 4 for dataset idx 4 using map is 16.094
[2024-09-07 22:10:30 Info] Finished epoch number 4, Took 24 seconds
Round - 4,Client - 5
2847, 2177, 2847
[2024-09-07 22:10:32 Info] Task wise accuracies after round 4 are [10.35, 19.17, 14.98, 26.6]
[2024-09-07 22:10:32 Info] Client 0 task-wise loss and accuracies are - ([2.522, 2.499, 2.311, 2.217], [10.35, 19.17, 14.98, 26.6])
[2024-09-07 22:10:35 Info] Task wise accuracies after round 4 are [9.95, 16.27, 11.62, 16.26]
[2024-09-07 22:10:35 Info] Client 1 task-wise loss and accuracies are - ([3.21, 3.019, 3.093, 3.066], [9.95, 16.27, 11.62, 16.26])
[2024-09-07 22:10:37 Info] Task wise accuracies after round 4 are [8.92, 8.92, 8.92, 8.92]
[2024-09-07 22:10:37 Info] Client 2 task-wise loss and accuracies are - ([158.199, 157.545, 158.43, 157.392], [8.92, 8.92, 8.92, 8.92])
[2024-09-07 22:10:40 Info] Task wise accuracies after round 4 are [9.75, 17.23, 12.21, 14.82]
[2024-09-07 22:10:40 Info] Client 3 task-wise loss and accuracies are - ([3.083, 2.943, 2.957, 2.871], [9.75, 17.23, 12.21, 14.82])
[2024-09-07 22:10:42 Info] Task wise accuracies after round 4 are [11.32, 13.92, 17.95, 14.58]
[2024-09-07 22:10:42 Info] Client 4 task-wise loss and accuracies are - ([3.237, 3.256, 3.087, 2.996], [11.32, 13.92, 17.95, 14.58])
[2024-09-07 22:10:45 Info] Task wise accuracies after round 4 are [8.92, 8.92, 8.92, 8.92]
[2024-09-07 22:10:45 Info] Value of server model at round 4 is -83.66393280029297
[2024-09-07 22:10:45 Info] Aggregated model avg acc and avg loss - (8.92, 29.882)
[2024-09-07 22:10:45 Info] Round - 4 complete
4
[2024-09-07 22:10:45 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:10:45 Info] Gradient clipping with max_norm being done
Model id is  139705895859344
Model value at client 1 is -83.66393280029297 in round 5
[2024-09-07 22:10:45 Info] Training epoch number 5 with dataset number 0
[2024-09-07 22:11:00 Info] Client id 0, Epoch 5, train set, Iter 500 current average loss 4.0307
[2024-09-07 22:11:01 Info] Running test set for epoch number 5 for dataset idx 0 using map
[2024-09-07 22:11:01 Info] Stats for test [map] set of size 10000, loss is 2217.9763, acc is 10.09%
[2024-09-07 22:11:01 Info] Running test set for epoch number 5 for dataset idx 1 using map
[2024-09-07 22:11:02 Info] Stats for test [map] set of size 10000, loss is 2217.7939, acc is 10.09%
[2024-09-07 22:11:02 Info] Running test set for epoch number 5 for dataset idx 2 using map
[2024-09-07 22:11:02 Info] Stats for test [map] set of size 10000, loss is 2217.9564, acc is 10.09%
[2024-09-07 22:11:02 Info] Running test set for epoch number 5 for dataset idx 3 using map
[2024-09-07 22:11:03 Info] Stats for test [map] set of size 10000, loss is 2217.6349, acc is 10.09%
[2024-09-07 22:11:03 Info] Running test set for epoch number 5 for dataset idx 4 using map
[2024-09-07 22:11:04 Info] Stats for test [map] set of size 10000, loss is 2219.0372, acc is 17.19%
[2024-09-07 22:11:04 Info] Average accuracy over all tasks for epoch number 5 for dataset idx 4 using map is 11.51
[2024-09-07 22:11:04 Info] Finished epoch number 5, Took 18 seconds
Round - 5,Client - 1
3350, 2847, 3350
[2024-09-07 22:11:04 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:11:04 Info] Gradient clipping with max_norm being done
Model id is  139706002438032
Model value at client 2 is -83.66393280029297 in round 5
[2024-09-07 22:11:04 Info] Training epoch number 5 with dataset number 0
[2024-09-07 22:11:19 Info] Client id 1, Epoch 5, train set, Iter 500 current average loss 30.1437
[2024-09-07 22:11:19 Info] Running test set for epoch number 5 for dataset idx 0 using map
[2024-09-07 22:11:20 Info] Stats for test [map] set of size 10000, loss is 1229.1022, acc is 9.82%
[2024-09-07 22:11:20 Info] Running test set for epoch number 5 for dataset idx 1 using map
[2024-09-07 22:11:21 Info] Stats for test [map] set of size 10000, loss is 1228.7699, acc is 9.82%
[2024-09-07 22:11:21 Info] Running test set for epoch number 5 for dataset idx 2 using map
[2024-09-07 22:11:21 Info] Stats for test [map] set of size 10000, loss is 1229.0287, acc is 9.82%
[2024-09-07 22:11:21 Info] Running test set for epoch number 5 for dataset idx 3 using map
[2024-09-07 22:11:22 Info] Stats for test [map] set of size 10000, loss is 1228.9319, acc is 9.82%
[2024-09-07 22:11:22 Info] Running test set for epoch number 5 for dataset idx 4 using map
[2024-09-07 22:11:23 Info] Stats for test [map] set of size 10000, loss is 1228.6819, acc is 9.96%
[2024-09-07 22:11:23 Info] Average accuracy over all tasks for epoch number 5 for dataset idx 4 using map is 9.848
[2024-09-07 22:11:23 Info] Finished epoch number 5, Took 18 seconds
Round - 5,Client - 2
3350, 2847, 3350
[2024-09-07 22:11:23 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:11:23 Info] Gradient clipping with max_norm being done
Model id is  139706001537152
Model value at client 3 is -83.66393280029297 in round 5
[2024-09-07 22:11:23 Info] Training epoch number 5 with dataset number 0
[2024-09-07 22:11:38 Info] Client id 2, Epoch 5, train set, Iter 500 current average loss 194596.5886
[2024-09-07 22:11:38 Info] Running test set for epoch number 5 for dataset idx 0 using map
[2024-09-07 22:11:39 Info] Stats for test [map] set of size 10000, loss is 213053.9491, acc is 8.92%
[2024-09-07 22:11:39 Info] Running test set for epoch number 5 for dataset idx 1 using map
[2024-09-07 22:11:40 Info] Stats for test [map] set of size 10000, loss is 213032.1782, acc is 8.92%
[2024-09-07 22:11:40 Info] Running test set for epoch number 5 for dataset idx 2 using map
[2024-09-07 22:11:40 Info] Stats for test [map] set of size 10000, loss is 213070.5243, acc is 8.92%
[2024-09-07 22:11:40 Info] Running test set for epoch number 5 for dataset idx 3 using map
[2024-09-07 22:11:41 Info] Stats for test [map] set of size 10000, loss is 212985.664, acc is 8.92%
[2024-09-07 22:11:41 Info] Running test set for epoch number 5 for dataset idx 4 using map
[2024-09-07 22:11:42 Info] Stats for test [map] set of size 10000, loss is 212210.2442, acc is 8.92%
[2024-09-07 22:11:42 Info] Average accuracy over all tasks for epoch number 5 for dataset idx 4 using map is 8.92
[2024-09-07 22:11:42 Info] Finished epoch number 5, Took 18 seconds
Round - 5,Client - 3
3350, 2847, 3350
[2024-09-07 22:11:42 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:11:42 Info] Gradient clipping with max_norm being done
Model id is  139706002424832
Model value at client 4 is -83.66393280029297 in round 5
[2024-09-07 22:11:42 Info] Training epoch number 5 with dataset number 0
[2024-09-07 22:11:57 Info] Client id 3, Epoch 5, train set, Iter 500 current average loss 4.1952
[2024-09-07 22:11:57 Info] Running test set for epoch number 5 for dataset idx 0 using map
[2024-09-07 22:11:57 Info] Stats for test [map] set of size 10000, loss is 6962.457, acc is 10.56%
[2024-09-07 22:11:57 Info] Running test set for epoch number 5 for dataset idx 1 using map
[2024-09-07 22:11:58 Info] Stats for test [map] set of size 10000, loss is 6962.173, acc is 12.9%
[2024-09-07 22:11:58 Info] Running test set for epoch number 5 for dataset idx 2 using map
[2024-09-07 22:11:59 Info] Stats for test [map] set of size 10000, loss is 6962.3217, acc is 11.14%
[2024-09-07 22:11:59 Info] Running test set for epoch number 5 for dataset idx 3 using map
[2024-09-07 22:12:00 Info] Stats for test [map] set of size 10000, loss is 6962.1905, acc is 17.7%
[2024-09-07 22:12:00 Info] Running test set for epoch number 5 for dataset idx 4 using map
[2024-09-07 22:12:00 Info] Stats for test [map] set of size 10000, loss is 6962.2123, acc is 18.68%
[2024-09-07 22:12:00 Info] Average accuracy over all tasks for epoch number 5 for dataset idx 4 using map is 14.196
[2024-09-07 22:12:00 Info] Finished epoch number 5, Took 18 seconds
Round - 5,Client - 4
3350, 2847, 3350
[2024-09-07 22:12:00 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.2}
It's here in new bgd optimizer
[2024-09-07 22:12:00 Info] Gradient clipping with max_norm being done
Model id is  139706001538880
Model value at client 5 is -83.66393280029297 in round 5
[2024-09-07 22:12:00 Info] Training epoch number 5 with dataset number 0
[2024-09-07 22:12:15 Info] Client id 4, Epoch 5, train set, Iter 500 current average loss 2.3369
[2024-09-07 22:12:16 Info] Running test set for epoch number 5 for dataset idx 0 using map
[2024-09-07 22:12:16 Info] Stats for test [map] set of size 10000, loss is 1519.556, acc is 9.03%
[2024-09-07 22:12:16 Info] Running test set for epoch number 5 for dataset idx 1 using map
[2024-09-07 22:12:17 Info] Stats for test [map] set of size 10000, loss is 1519.3524, acc is 14.3%
[2024-09-07 22:12:17 Info] Running test set for epoch number 5 for dataset idx 2 using map
[2024-09-07 22:12:18 Info] Stats for test [map] set of size 10000, loss is 1519.3418, acc is 15.89%
[2024-09-07 22:12:18 Info] Running test set for epoch number 5 for dataset idx 3 using map
[2024-09-07 22:12:18 Info] Stats for test [map] set of size 10000, loss is 1519.1618, acc is 13.51%
[2024-09-07 22:12:18 Info] Running test set for epoch number 5 for dataset idx 4 using map
[2024-09-07 22:12:19 Info] Stats for test [map] set of size 10000, loss is 1519.5568, acc is 19.82%
[2024-09-07 22:12:19 Info] Average accuracy over all tasks for epoch number 5 for dataset idx 4 using map is 14.51
[2024-09-07 22:12:19 Info] Finished epoch number 5, Took 18 seconds
Round - 5,Client - 5
3350, 2847, 3350
[2024-09-07 22:12:22 Info] Task wise accuracies after round 5 are [10.09, 10.09, 10.09, 10.09, 17.19]
[2024-09-07 22:12:22 Info] Client 0 task-wise loss and accuracies are - ([2227.807, 2227.625, 2227.788, 2227.464, 2228.87], [10.09, 10.09, 10.09, 10.09, 17.19])
[2024-09-07 22:12:26 Info] Task wise accuracies after round 5 are [9.82, 9.82, 9.82, 9.82, 9.96]
[2024-09-07 22:12:26 Info] Client 1 task-wise loss and accuracies are - ([1234.543, 1234.21, 1234.472, 1234.372, 1234.125], [9.82, 9.82, 9.82, 9.82, 9.96])
[2024-09-07 22:12:29 Info] Task wise accuracies after round 5 are [8.92, 8.92, 8.92, 8.92, 8.92]
[2024-09-07 22:12:29 Info] Client 2 task-wise loss and accuracies are - ([212960.219, 212938.354, 212976.937, 212891.565, 212113.62], [8.92, 8.92, 8.92, 8.92, 8.92])
[2024-09-07 22:12:33 Info] Task wise accuracies after round 5 are [10.56, 12.9, 11.14, 17.7, 18.68]
[2024-09-07 22:12:33 Info] Client 3 task-wise loss and accuracies are - ([6993.391, 6993.106, 6993.256, 6993.123, 6993.146], [10.56, 12.9, 11.14, 17.7, 18.68])
[2024-09-07 22:12:36 Info] Task wise accuracies after round 5 are [9.03, 14.3, 15.89, 13.51, 19.82]
[2024-09-07 22:12:36 Info] Client 4 task-wise loss and accuracies are - ([1526.301, 1526.096, 1526.085, 1525.904, 1526.302], [9.03, 14.3, 15.89, 13.51, 19.82])
[2024-09-07 22:12:39 Info] Task wise accuracies after round 5 are [8.92, 8.92, 8.92, 8.92, 8.92]
[2024-09-07 22:12:39 Info] Value of server model at round 5 is 20133.67578125
[2024-09-07 22:12:39 Info] Aggregated model avg acc and avg loss - (8.92, 18363.695)
[2024-09-07 22:12:39 Info] Round - 5 complete
[2024-09-07 22:12:39 Info] Avg Test Accuracies : [5.94, 11.37, 12.007, 8.92, 8.92]
[2024-09-07 22:12:39 Info] Avg Test Losses : [2.48, 2.347, 2.383, 29.882, 18363.695]
[2024-09-07 22:12:39 Info] Done - Federated Learning Setup
