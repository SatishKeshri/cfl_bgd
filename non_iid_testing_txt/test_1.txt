running with abalation!! Are you sure?
[2024-09-07 17:33:20 Info] Script args: Namespace(dataset='ds_cont_permuted_mnist', nn_arch='mnist_simple_net_200width_domainlearning_784input_10cls_1ds', logname='continous_permuted_mnist_5_tasks', results_dir='ds_cont_permuted_mnist_5_tasks_150_epochs_alpha_0.01_data_type_non_iid_1.0_mean_eta__bgd_new_update_optim_4_beta_with_grad_clip_23:03_07-09-2024', seed=1000, num_workers=8, num_epochs=150, batch_size=128, pruning_percents=[], train_mc_iters=10, std_init=0.05, mean_eta=1.0, permanent_prune_on_epoch=-1, permanent_prune_on_epoch_percent=90, momentum=0.9, lr=0.01, weight_decay=0.0005, test_freq=1, contpermuted_beta=4, optimizer='bgd_new_update', optimizer_params='{}', inference_mc=False, inference_map=True, inference_committee=False, inference_aggsoftmax=False, inference_initstd=False, committee_size=0, test_mc_iters=0, init_params=['{"bias_type":', '"xavier",', '"conv_type":', '"xavier",', '"bn_init":', '"01"}'], desc='', bw_to_rgb=False, permuted_offset=False, labels_trick=False, num_of_permutations=4, iterations_per_virtual_epc=67, separate_labels_space=False, permute_seed=2019, federated_learning=True, n_clients=5, num_aggs_per_task=1, grad_clip=True, max_grad_norm=1.0, non_iid_split=True, alpha=0.01, alpha_mg=0.1)
[2024-09-07 17:33:20 Info] Computer name: test-desktop with pytorch version: 2.2.2
Dataset is  ds_cont_permuted_mnist
[2024-09-07 17:33:20 Info] Arguments are Namespace(dataset='ds_cont_permuted_mnist', nn_arch='mnist_simple_net_200width_domainlearning_784input_10cls_1ds', logname='continous_permuted_mnist_5_tasks', results_dir='ds_cont_permuted_mnist_5_tasks_150_epochs_alpha_0.01_data_type_non_iid_1.0_mean_eta__bgd_new_update_optim_4_beta_with_grad_clip_23:03_07-09-2024', seed=1000, num_workers=8, num_epochs=150, batch_size=128, pruning_percents=[], train_mc_iters=10, std_init=0.05, mean_eta=1.0, permanent_prune_on_epoch=-1, permanent_prune_on_epoch_percent=90, momentum=0.9, lr=0.01, weight_decay=0.0005, test_freq=1, contpermuted_beta=4, optimizer='bgd_new_update', optimizer_params='{}', inference_mc=False, inference_map=True, inference_committee=False, inference_aggsoftmax=False, inference_initstd=False, committee_size=0, test_mc_iters=0, init_params=['{"bias_type":', '"xavier",', '"conv_type":', '"xavier",', '"bn_init":', '"01"}'], desc='', bw_to_rgb=False, permuted_offset=False, labels_trick=False, num_of_permutations=4, iterations_per_virtual_epc=67, separate_labels_space=False, permute_seed=2019, federated_learning=True, n_clients=5, num_aggs_per_task=1, grad_clip=True, max_grad_norm=1.0, non_iid_split=True, alpha=0.01, alpha_mg=0.1)
Took 7.000000000000001% of the P-MNSIT dataset
Took 7.000000000000001% of the P-MNSIT dataset
Took 7.000000000000001% of the P-MNSIT dataset
Took 7.000000000000001% of the P-MNSIT dataset
Took 7.000000000000001% of the P-MNSIT dataset
round_end_iters list [ 2512  4522  6532  8542 10050]
[ 2512  4522  6532  8542 10050]
5
Client Indices Generation starts
Non-IID split is happening and alpha is 0.01
Non-IID split is happening and alpha is 0.01
Non-IID split is happening and alpha is 0.01
Non-IID split is happening and alpha is 0.01
Non-IID split is happening and alpha is 0.01
Clients Indices Generation ends
Client Indices Generation took 7.611860990524292 seconds
1
[2024-09-07 17:33:28 Info] Transformed model to CUDA
[2024-09-07 17:33:28 Info] Initialized 0 Conv2d layers using nn.init.xavier_normal_
[2024-09-07 17:33:28 Info] Initialized 3 linear layers using xavier
[2024-09-07 17:33:28 Info] Initialized 0 bias conv2d layers using nn.init.xavier.noraml_
[2024-09-07 17:33:28 Info] Initialized 3 bias linear layers using xavier
[2024-09-07 17:33:28 Info] Initialized 0 BN layers using weight=1 and bias=0
[2024-09-07 17:33:28 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.1}
It's here in new bgd optimizer
0
[2024-09-07 17:33:28 Info] Inference method: {'map'}
[2024-09-07 17:33:28 Info] Number of parameters in the model is 199,210
[2024-09-07 17:33:28 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-07 17:33:28 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.1}
It's here in new bgd optimizer
[2024-09-07 17:33:28 Info] Gradient clipping with max_norm being done
Model id is  139902666962928
Model value at client 1 is -0.9189211130142212 in round 1
[2024-09-07 17:33:28 Info] Training epoch number 1 with dataset number 0
[2024-09-07 17:33:43 Info] Client id 0, Epoch 1, train set, Iter 500 current average loss 0.688
[2024-09-07 17:33:56 Info] Client id 0, Epoch 1, train set, Iter 1000 current average loss 0.6759
[2024-09-07 17:34:09 Info] Client id 0, Epoch 1, train set, Iter 1500 current average loss 0.6737
[2024-09-07 17:34:22 Info] Client id 0, Epoch 1, train set, Iter 2000 current average loss 0.7108
[2024-09-07 17:34:34 Info] Client id 0, Epoch 1, train set, Iter 2500 current average loss 0.7549
[2024-09-07 17:34:35 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-07 17:34:35 Info] Stats for test [map] set of size 10000, loss is 2.6444, acc is 9.13%
[2024-09-07 17:34:35 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-07 17:34:35 Info] Stats for test [map] set of size 10000, loss is 3.1156, acc is 18.61%
[2024-09-07 17:34:35 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-07 17:34:36 Info] Stats for test [map] set of size 10000, loss is 2.7156, acc is 9.94%
[2024-09-07 17:34:36 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-07 17:34:36 Info] Stats for test [map] set of size 10000, loss is 2.6346, acc is 9.82%
[2024-09-07 17:34:36 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-07 17:34:37 Info] Stats for test [map] set of size 10000, loss is 2.6171, acc is 9.92%
[2024-09-07 17:34:37 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 11.484
[2024-09-07 17:34:37 Info] Finished epoch number 1, Took 68 seconds
Round - 1,Client - 1
2512, 0, 2512
[2024-09-07 17:34:37 Info] Inference method: {'map'}
[2024-09-07 17:34:37 Info] Number of parameters in the model is 199,210
[2024-09-07 17:34:37 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-07 17:34:37 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.1}
It's here in new bgd optimizer
[2024-09-07 17:34:37 Info] Gradient clipping with max_norm being done
Model id is  139902393556112
Model value at client 2 is -0.9189211130142212 in round 1
[2024-09-07 17:34:37 Info] Training epoch number 1 with dataset number 0
[2024-09-07 17:34:51 Info] Client id 1, Epoch 1, train set, Iter 500 current average loss 0.5784
[2024-09-07 17:35:03 Info] Client id 1, Epoch 1, train set, Iter 1000 current average loss 0.5764
[2024-09-07 17:35:16 Info] Client id 1, Epoch 1, train set, Iter 1500 current average loss 0.5729
[2024-09-07 17:35:30 Info] Client id 1, Epoch 1, train set, Iter 2000 current average loss 0.5641
[2024-09-07 17:35:42 Info] Client id 1, Epoch 1, train set, Iter 2500 current average loss 0.4972
[2024-09-07 17:35:43 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-07 17:35:43 Info] Stats for test [map] set of size 10000, loss is 2.8087, acc is 9.58%
[2024-09-07 17:35:43 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-07 17:35:44 Info] Stats for test [map] set of size 10000, loss is 5.083, acc is 9.58%
[2024-09-07 17:35:44 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-07 17:35:44 Info] Stats for test [map] set of size 10000, loss is 3.1291, acc is 9.58%
[2024-09-07 17:35:44 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-07 17:35:45 Info] Stats for test [map] set of size 10000, loss is 3.2255, acc is 9.58%
[2024-09-07 17:35:45 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-07 17:35:45 Info] Stats for test [map] set of size 10000, loss is 3.0254, acc is 9.58%
[2024-09-07 17:35:45 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 9.58
[2024-09-07 17:35:45 Info] Finished epoch number 1, Took 68 seconds
Round - 1,Client - 2
2512, 0, 2512
[2024-09-07 17:35:45 Info] Inference method: {'map'}
[2024-09-07 17:35:45 Info] Number of parameters in the model is 199,210
[2024-09-07 17:35:45 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-07 17:35:45 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.1}
It's here in new bgd optimizer
[2024-09-07 17:35:45 Info] Gradient clipping with max_norm being done
Model id is  139902520736160
Model value at client 3 is -0.9189211130142212 in round 1
[2024-09-07 17:35:45 Info] Training epoch number 1 with dataset number 0
[2024-09-07 17:35:59 Info] Client id 2, Epoch 1, train set, Iter 500 current average loss 0.3695
[2024-09-07 17:36:12 Info] Client id 2, Epoch 1, train set, Iter 1000 current average loss 0.3689
[2024-09-07 17:36:25 Info] Client id 2, Epoch 1, train set, Iter 1500 current average loss 0.3677
[2024-09-07 17:36:38 Info] Client id 2, Epoch 1, train set, Iter 2000 current average loss 0.4086
[2024-09-07 17:36:51 Info] Client id 2, Epoch 1, train set, Iter 2500 current average loss 0.4574
[2024-09-07 17:36:51 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-07 17:36:51 Info] Stats for test [map] set of size 10000, loss is 2.4727, acc is 10.77%
[2024-09-07 17:36:51 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-07 17:36:52 Info] Stats for test [map] set of size 10000, loss is 2.8517, acc is 27.47%
[2024-09-07 17:36:52 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-07 17:36:52 Info] Stats for test [map] set of size 10000, loss is 2.6127, acc is 9.45%
[2024-09-07 17:36:52 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-07 17:36:53 Info] Stats for test [map] set of size 10000, loss is 2.6296, acc is 10.11%
[2024-09-07 17:36:53 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-07 17:36:53 Info] Stats for test [map] set of size 10000, loss is 2.5724, acc is 6.9%
[2024-09-07 17:36:53 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 12.94
[2024-09-07 17:36:53 Info] Finished epoch number 1, Took 68 seconds
Round - 1,Client - 3
2512, 0, 2512
[2024-09-07 17:36:53 Info] Inference method: {'map'}
[2024-09-07 17:36:53 Info] Number of parameters in the model is 199,210
[2024-09-07 17:36:53 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-07 17:36:53 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.1}
It's here in new bgd optimizer
[2024-09-07 17:36:53 Info] Gradient clipping with max_norm being done
Model id is  139902393553328
Model value at client 4 is -0.9189211130142212 in round 1
[2024-09-07 17:36:53 Info] Training epoch number 1 with dataset number 0
[2024-09-07 17:37:08 Info] Client id 3, Epoch 1, train set, Iter 500 current average loss 0.5209
[2024-09-07 17:37:21 Info] Client id 3, Epoch 1, train set, Iter 1000 current average loss 0.5131
[2024-09-07 17:37:34 Info] Client id 3, Epoch 1, train set, Iter 1500 current average loss 0.5114
[2024-09-07 17:37:48 Info] Client id 3, Epoch 1, train set, Iter 2000 current average loss 0.5523
[2024-09-07 17:38:00 Info] Client id 3, Epoch 1, train set, Iter 2500 current average loss 0.579
[2024-09-07 17:38:01 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-07 17:38:01 Info] Stats for test [map] set of size 10000, loss is 2.6949, acc is 10.09%
[2024-09-07 17:38:01 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-07 17:38:02 Info] Stats for test [map] set of size 10000, loss is 3.293, acc is 26.01%
[2024-09-07 17:38:02 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-07 17:38:02 Info] Stats for test [map] set of size 10000, loss is 2.8424, acc is 12.13%
[2024-09-07 17:38:02 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-07 17:38:03 Info] Stats for test [map] set of size 10000, loss is 2.8036, acc is 12.63%
[2024-09-07 17:38:03 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-07 17:38:03 Info] Stats for test [map] set of size 10000, loss is 2.8434, acc is 13.21%
[2024-09-07 17:38:03 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 14.814
[2024-09-07 17:38:03 Info] Finished epoch number 1, Took 69 seconds
Round - 1,Client - 4
2512, 0, 2512
[2024-09-07 17:38:03 Info] Inference method: {'map'}
[2024-09-07 17:38:03 Info] Number of parameters in the model is 199,210
[2024-09-07 17:38:03 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-07 17:38:03 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.1}
It's here in new bgd optimizer
[2024-09-07 17:38:03 Info] Gradient clipping with max_norm being done
Model id is  139902393555632
Model value at client 5 is -0.9189211130142212 in round 1
[2024-09-07 17:38:03 Info] Training epoch number 1 with dataset number 0
[2024-09-07 17:38:17 Info] Client id 4, Epoch 1, train set, Iter 500 current average loss 0.36
[2024-09-07 17:38:30 Info] Client id 4, Epoch 1, train set, Iter 1000 current average loss 0.3474
[2024-09-07 17:38:43 Info] Client id 4, Epoch 1, train set, Iter 1500 current average loss 0.3435
[2024-09-07 17:38:55 Info] Client id 4, Epoch 1, train set, Iter 2000 current average loss 0.4051
[2024-09-07 17:39:08 Info] Client id 4, Epoch 1, train set, Iter 2500 current average loss 0.4815
[2024-09-07 17:39:08 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-07 17:39:09 Info] Stats for test [map] set of size 10000, loss is 2.5992, acc is 9.46%
[2024-09-07 17:39:09 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-07 17:39:09 Info] Stats for test [map] set of size 10000, loss is 3.0017, acc is 25.3%
[2024-09-07 17:39:09 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-07 17:39:10 Info] Stats for test [map] set of size 10000, loss is 2.697, acc is 11.41%
[2024-09-07 17:39:10 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-07 17:39:10 Info] Stats for test [map] set of size 10000, loss is 2.635, acc is 13.48%
[2024-09-07 17:39:10 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-07 17:39:11 Info] Stats for test [map] set of size 10000, loss is 2.6747, acc is 9.93%
[2024-09-07 17:39:11 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 13.916
[2024-09-07 17:39:11 Info] Finished epoch number 1, Took 67 seconds
Round - 1,Client - 5
2512, 0, 2512
[2024-09-07 17:39:11 Info] Task wise accuracies after round 1 are [9.13]
[2024-09-07 17:39:11 Info] Client 0 task-wise loss and accuracies are - ([2.645], [9.13])
[2024-09-07 17:39:12 Info] Task wise accuracies after round 1 are [9.58]
[2024-09-07 17:39:12 Info] Client 1 task-wise loss and accuracies are - ([2.808], [9.58])
[2024-09-07 17:39:12 Info] Task wise accuracies after round 1 are [10.77]
[2024-09-07 17:39:12 Info] Client 2 task-wise loss and accuracies are - ([2.474], [10.77])
[2024-09-07 17:39:13 Info] Task wise accuracies after round 1 are [10.09]
[2024-09-07 17:39:13 Info] Client 3 task-wise loss and accuracies are - ([2.696], [10.09])
[2024-09-07 17:39:13 Info] Task wise accuracies after round 1 are [9.46]
[2024-09-07 17:39:13 Info] Client 4 task-wise loss and accuracies are - ([2.602], [9.46])
[2024-09-07 17:39:14 Info] Task wise accuracies after round 1 are [4.58]
[2024-09-07 17:39:14 Info] Value of server model at round 1 is 69.22118377685547
[2024-09-07 17:39:14 Info] Aggregated model avg acc and avg loss - (4.58, 2.467)
[2024-09-07 17:39:14 Info] Round - 1 complete
1
[2024-09-07 17:39:14 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.1}
It's here in new bgd optimizer
[2024-09-07 17:39:14 Info] Gradient clipping with max_norm being done
Model id is  139902393550640
Model value at client 1 is 69.22118377685547 in round 2
[2024-09-07 17:39:14 Info] Training epoch number 2 with dataset number 0
[2024-09-07 17:39:27 Info] Client id 0, Epoch 2, train set, Iter 500 current average loss 0.8874
[2024-09-07 17:39:39 Info] Client id 0, Epoch 2, train set, Iter 1000 current average loss 0.8818
[2024-09-07 17:39:52 Info] Client id 0, Epoch 2, train set, Iter 1500 current average loss 0.9069
[2024-09-07 17:40:04 Info] Client id 0, Epoch 2, train set, Iter 2000 current average loss 0.8692
[2024-09-07 17:40:04 Info] Running test set for epoch number 2 for dataset idx 0 using map
[2024-09-07 17:40:05 Info] Stats for test [map] set of size 10000, loss is 2.644, acc is 14.18%
[2024-09-07 17:40:05 Info] Running test set for epoch number 2 for dataset idx 1 using map
[2024-09-07 17:40:05 Info] Stats for test [map] set of size 10000, loss is 2.5856, acc is 15.49%
[2024-09-07 17:40:05 Info] Running test set for epoch number 2 for dataset idx 2 using map
[2024-09-07 17:40:06 Info] Stats for test [map] set of size 10000, loss is 3.3143, acc is 19.72%
[2024-09-07 17:40:06 Info] Running test set for epoch number 2 for dataset idx 3 using map
[2024-09-07 17:40:06 Info] Stats for test [map] set of size 10000, loss is 2.6698, acc is 13.09%
[2024-09-07 17:40:06 Info] Running test set for epoch number 2 for dataset idx 4 using map
[2024-09-07 17:40:07 Info] Stats for test [map] set of size 10000, loss is 2.6588, acc is 12.38%
[2024-09-07 17:40:07 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 4 using map is 14.972
[2024-09-07 17:40:07 Info] Finished epoch number 2, Took 53 seconds
Round - 2,Client - 1
4522, 2512, 4522
[2024-09-07 17:40:07 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.1}
It's here in new bgd optimizer
[2024-09-07 17:40:07 Info] Gradient clipping with max_norm being done
Model id is  139902393807584
Model value at client 2 is 69.22118377685547 in round 2
[2024-09-07 17:40:07 Info] Training epoch number 2 with dataset number 0
[2024-09-07 17:40:20 Info] Client id 1, Epoch 2, train set, Iter 500 current average loss 0.0233
[2024-09-07 17:40:32 Info] Client id 1, Epoch 2, train set, Iter 1000 current average loss 0.0198
[2024-09-07 17:40:45 Info] Client id 1, Epoch 2, train set, Iter 1500 current average loss 0.0861
[2024-09-07 17:40:58 Info] Client id 1, Epoch 2, train set, Iter 2000 current average loss 0.2031
[2024-09-07 17:40:58 Info] Running test set for epoch number 2 for dataset idx 0 using map
[2024-09-07 17:40:59 Info] Stats for test [map] set of size 10000, loss is 2.8388, acc is 10.33%
[2024-09-07 17:40:59 Info] Running test set for epoch number 2 for dataset idx 1 using map
[2024-09-07 17:40:59 Info] Stats for test [map] set of size 10000, loss is 2.4866, acc is 10.73%
[2024-09-07 17:40:59 Info] Running test set for epoch number 2 for dataset idx 2 using map
[2024-09-07 17:41:00 Info] Stats for test [map] set of size 10000, loss is 3.1779, acc is 17.88%
[2024-09-07 17:41:00 Info] Running test set for epoch number 2 for dataset idx 3 using map
[2024-09-07 17:41:00 Info] Stats for test [map] set of size 10000, loss is 2.8026, acc is 10.32%
[2024-09-07 17:41:00 Info] Running test set for epoch number 2 for dataset idx 4 using map
[2024-09-07 17:41:01 Info] Stats for test [map] set of size 10000, loss is 2.7193, acc is 10.32%
[2024-09-07 17:41:01 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 4 using map is 11.916
[2024-09-07 17:41:01 Info] Finished epoch number 2, Took 54 seconds
Round - 2,Client - 2
4522, 2512, 4522
[2024-09-07 17:41:01 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.1}
It's here in new bgd optimizer
[2024-09-07 17:41:01 Info] Gradient clipping with max_norm being done
Model id is  139902393798272
Model value at client 3 is 69.22118377685547 in round 2
[2024-09-07 17:41:01 Info] Training epoch number 2 with dataset number 0
[2024-09-07 17:41:15 Info] Client id 2, Epoch 2, train set, Iter 500 current average loss 0.5677
[2024-09-07 17:41:27 Info] Client id 2, Epoch 2, train set, Iter 1000 current average loss 0.5517
[2024-09-07 17:41:40 Info] Client id 2, Epoch 2, train set, Iter 1500 current average loss 0.5812
[2024-09-07 17:41:52 Info] Client id 2, Epoch 2, train set, Iter 2000 current average loss 0.5661
[2024-09-07 17:41:53 Info] Running test set for epoch number 2 for dataset idx 0 using map
[2024-09-07 17:41:53 Info] Stats for test [map] set of size 10000, loss is 2.6758, acc is 9.8%
[2024-09-07 17:41:53 Info] Running test set for epoch number 2 for dataset idx 1 using map
[2024-09-07 17:41:54 Info] Stats for test [map] set of size 10000, loss is 2.8449, acc is 11.34%
[2024-09-07 17:41:54 Info] Running test set for epoch number 2 for dataset idx 2 using map
[2024-09-07 17:41:54 Info] Stats for test [map] set of size 10000, loss is 4.0291, acc is 19.08%
[2024-09-07 17:41:54 Info] Running test set for epoch number 2 for dataset idx 3 using map
[2024-09-07 17:41:55 Info] Stats for test [map] set of size 10000, loss is 2.7144, acc is 8.79%
[2024-09-07 17:41:55 Info] Running test set for epoch number 2 for dataset idx 4 using map
[2024-09-07 17:41:55 Info] Stats for test [map] set of size 10000, loss is 2.741, acc is 10.27%
[2024-09-07 17:41:55 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 4 using map is 11.856
[2024-09-07 17:41:55 Info] Finished epoch number 2, Took 54 seconds
Round - 2,Client - 3
4522, 2512, 4522
[2024-09-07 17:41:55 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.1}
It's here in new bgd optimizer
[2024-09-07 17:41:55 Info] Gradient clipping with max_norm being done
Model id is  139902666963168
Model value at client 4 is 69.22118377685547 in round 2
[2024-09-07 17:41:55 Info] Training epoch number 2 with dataset number 0
[2024-09-07 17:42:08 Info] Client id 3, Epoch 2, train set, Iter 500 current average loss 0.4782
[2024-09-07 17:42:21 Info] Client id 3, Epoch 2, train set, Iter 1000 current average loss 0.471
[2024-09-07 17:42:34 Info] Client id 3, Epoch 2, train set, Iter 1500 current average loss 0.5203
[2024-09-07 17:42:47 Info] Client id 3, Epoch 2, train set, Iter 2000 current average loss 0.5702
[2024-09-07 17:42:47 Info] Running test set for epoch number 2 for dataset idx 0 using map
[2024-09-07 17:42:48 Info] Stats for test [map] set of size 10000, loss is 2.7887, acc is 10.18%
[2024-09-07 17:42:48 Info] Running test set for epoch number 2 for dataset idx 1 using map
[2024-09-07 17:42:48 Info] Stats for test [map] set of size 10000, loss is 2.8986, acc is 11.31%
[2024-09-07 17:42:48 Info] Running test set for epoch number 2 for dataset idx 2 using map
[2024-09-07 17:42:49 Info] Stats for test [map] set of size 10000, loss is 3.8155, acc is 17.06%
[2024-09-07 17:42:49 Info] Running test set for epoch number 2 for dataset idx 3 using map
[2024-09-07 17:42:49 Info] Stats for test [map] set of size 10000, loss is 2.8017, acc is 8.89%
[2024-09-07 17:42:49 Info] Running test set for epoch number 2 for dataset idx 4 using map
[2024-09-07 17:42:50 Info] Stats for test [map] set of size 10000, loss is 2.8642, acc is 9.27%
[2024-09-07 17:42:50 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 4 using map is 11.342
[2024-09-07 17:42:50 Info] Finished epoch number 2, Took 54 seconds
Round - 2,Client - 4
4522, 2512, 4522
[2024-09-07 17:42:50 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.1}
It's here in new bgd optimizer
[2024-09-07 17:42:50 Info] Gradient clipping with max_norm being done
Model id is  139902666963840
Model value at client 5 is 69.22118377685547 in round 2
[2024-09-07 17:42:50 Info] Training epoch number 2 with dataset number 0
[2024-09-07 17:43:04 Info] Client id 4, Epoch 2, train set, Iter 500 current average loss 0.6855
[2024-09-07 17:43:17 Info] Client id 4, Epoch 2, train set, Iter 1000 current average loss 0.673
[2024-09-07 17:43:30 Info] Client id 4, Epoch 2, train set, Iter 1500 current average loss 0.6795
[2024-09-07 17:43:43 Info] Client id 4, Epoch 2, train set, Iter 2000 current average loss 0.6445
[2024-09-07 17:43:43 Info] Running test set for epoch number 2 for dataset idx 0 using map
[2024-09-07 17:43:43 Info] Stats for test [map] set of size 10000, loss is 2.8122, acc is 9.35%
[2024-09-07 17:43:43 Info] Running test set for epoch number 2 for dataset idx 1 using map
[2024-09-07 17:43:44 Info] Stats for test [map] set of size 10000, loss is 2.8526, acc is 19.44%
[2024-09-07 17:43:44 Info] Running test set for epoch number 2 for dataset idx 2 using map
[2024-09-07 17:43:44 Info] Stats for test [map] set of size 10000, loss is 3.3578, acc is 25.31%
[2024-09-07 17:43:44 Info] Running test set for epoch number 2 for dataset idx 3 using map
[2024-09-07 17:43:45 Info] Stats for test [map] set of size 10000, loss is 2.9035, acc is 12.27%
[2024-09-07 17:43:45 Info] Running test set for epoch number 2 for dataset idx 4 using map
[2024-09-07 17:43:45 Info] Stats for test [map] set of size 10000, loss is 2.8214, acc is 10.66%
[2024-09-07 17:43:45 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 4 using map is 15.406
[2024-09-07 17:43:45 Info] Finished epoch number 2, Took 55 seconds
Round - 2,Client - 5
4522, 2512, 4522
[2024-09-07 17:43:46 Info] Task wise accuracies after round 2 are [14.18, 15.49]
[2024-09-07 17:43:46 Info] Client 0 task-wise loss and accuracies are - ([2.646, 2.588], [14.18, 15.49])
[2024-09-07 17:43:47 Info] Task wise accuracies after round 2 are [10.33, 10.73]
[2024-09-07 17:43:47 Info] Client 1 task-wise loss and accuracies are - ([2.841, 2.486], [10.33, 10.73])
[2024-09-07 17:43:48 Info] Task wise accuracies after round 2 are [9.8, 11.34]
[2024-09-07 17:43:48 Info] Client 2 task-wise loss and accuracies are - ([2.676, 2.848], [9.8, 11.34])
[2024-09-07 17:43:49 Info] Task wise accuracies after round 2 are [10.18, 11.31]
[2024-09-07 17:43:49 Info] Client 3 task-wise loss and accuracies are - ([2.789, 2.9], [10.18, 11.31])
[2024-09-07 17:43:50 Info] Task wise accuracies after round 2 are [9.35, 19.44]
[2024-09-07 17:43:50 Info] Client 4 task-wise loss and accuracies are - ([2.815, 2.858], [9.35, 19.44])
[2024-09-07 17:43:51 Info] Task wise accuracies after round 2 are [10.24, 10.9]
[2024-09-07 17:43:51 Info] Value of server model at round 2 is 108.64610290527344
[2024-09-07 17:43:51 Info] Aggregated model avg acc and avg loss - (10.57, 2.51)
[2024-09-07 17:43:51 Info] Round - 2 complete
2
[2024-09-07 17:43:51 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.1}
It's here in new bgd optimizer
[2024-09-07 17:43:51 Info] Gradient clipping with max_norm being done
Model id is  139902393552320
Model value at client 1 is 108.64610290527344 in round 3
[2024-09-07 17:43:51 Info] Training epoch number 3 with dataset number 0
[2024-09-07 17:44:05 Info] Client id 0, Epoch 3, train set, Iter 500 current average loss 0.5781
[2024-09-07 17:44:18 Info] Client id 0, Epoch 3, train set, Iter 1000 current average loss 0.5742
[2024-09-07 17:44:32 Info] Client id 0, Epoch 3, train set, Iter 1500 current average loss 0.5988
[2024-09-07 17:44:45 Info] Client id 0, Epoch 3, train set, Iter 2000 current average loss 0.6295
[2024-09-07 17:44:46 Info] Running test set for epoch number 3 for dataset idx 0 using map
[2024-09-07 17:44:46 Info] Stats for test [map] set of size 10000, loss is 2.7716, acc is 9.81%
[2024-09-07 17:44:46 Info] Running test set for epoch number 3 for dataset idx 1 using map
[2024-09-07 17:44:47 Info] Stats for test [map] set of size 10000, loss is 2.9786, acc is 12.71%
[2024-09-07 17:44:47 Info] Running test set for epoch number 3 for dataset idx 2 using map
[2024-09-07 17:44:47 Info] Stats for test [map] set of size 10000, loss is 3.0378, acc is 10.41%
[2024-09-07 17:44:47 Info] Running test set for epoch number 3 for dataset idx 3 using map
[2024-09-07 17:44:48 Info] Stats for test [map] set of size 10000, loss is 3.4283, acc is 18.5%
[2024-09-07 17:44:48 Info] Running test set for epoch number 3 for dataset idx 4 using map
[2024-09-07 17:44:48 Info] Stats for test [map] set of size 10000, loss is 2.834, acc is 11.71%
[2024-09-07 17:44:48 Info] Average accuracy over all tasks for epoch number 3 for dataset idx 4 using map is 12.628
[2024-09-07 17:44:48 Info] Finished epoch number 3, Took 57 seconds
Round - 3,Client - 1
6532, 4522, 6532
[2024-09-07 17:44:48 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.1}
It's here in new bgd optimizer
[2024-09-07 17:44:48 Info] Gradient clipping with max_norm being done
Model id is  139902666956832
Model value at client 2 is 108.64610290527344 in round 3
[2024-09-07 17:44:48 Info] Training epoch number 3 with dataset number 0
[2024-09-07 17:45:02 Info] Client id 1, Epoch 3, train set, Iter 500 current average loss 0.6525
[2024-09-07 17:45:14 Info] Client id 1, Epoch 3, train set, Iter 1000 current average loss 0.6431
[2024-09-07 17:45:27 Info] Client id 1, Epoch 3, train set, Iter 1500 current average loss 0.6526
[2024-09-07 17:45:40 Info] Client id 1, Epoch 3, train set, Iter 2000 current average loss 0.6205
[2024-09-07 17:45:40 Info] Running test set for epoch number 3 for dataset idx 0 using map
[2024-09-07 17:45:41 Info] Stats for test [map] set of size 10000, loss is 2.8386, acc is 6.41%
[2024-09-07 17:45:41 Info] Running test set for epoch number 3 for dataset idx 1 using map
[2024-09-07 17:45:41 Info] Stats for test [map] set of size 10000, loss is 2.9909, acc is 9.85%
[2024-09-07 17:45:41 Info] Running test set for epoch number 3 for dataset idx 2 using map
[2024-09-07 17:45:42 Info] Stats for test [map] set of size 10000, loss is 2.6818, acc is 10.82%
[2024-09-07 17:45:42 Info] Running test set for epoch number 3 for dataset idx 3 using map
[2024-09-07 17:45:42 Info] Stats for test [map] set of size 10000, loss is 3.4309, acc is 17.68%
[2024-09-07 17:45:42 Info] Running test set for epoch number 3 for dataset idx 4 using map
[2024-09-07 17:45:43 Info] Stats for test [map] set of size 10000, loss is 2.8425, acc is 10.16%
[2024-09-07 17:45:43 Info] Average accuracy over all tasks for epoch number 3 for dataset idx 4 using map is 10.984
[2024-09-07 17:45:43 Info] Finished epoch number 3, Took 54 seconds
Round - 3,Client - 2
6532, 4522, 6532
[2024-09-07 17:45:43 Info] BGD params: {'mean_eta': 1.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.1}
It's here in new bgd optimizer
[2024-09-07 17:45:43 Info] Gradient clipping with max_norm being done
Model id is  139902666963936
Model value at client 3 is 108.64610290527344 in round 3
[2024-09-07 17:45:43 Info] Training epoch number 3 with dataset number 0
[2024-09-07 17:45:57 Info] Client id 2, Epoch 3, train set, Iter 500 current average loss 0.2948
