running with abalation!! Are you sure?
[2024-09-07 22:12:43 Info] Script args: Namespace(dataset='ds_cont_permuted_mnist', nn_arch='mnist_simple_net_200width_domainlearning_784input_10cls_1ds', logname='continous_permuted_mnist_5_tasks', results_dir='ds_cont_permuted_mnist_5_tasks_50_epochs_alpha_0.01_data_type_non_iid_3.0_mean_eta__bgd_new_update_optim_4_beta_with_grad_clip_03:42_08-09-2024', seed=1000, num_workers=8, num_epochs=50, batch_size=128, pruning_percents=[], train_mc_iters=10, std_init=0.05, mean_eta=3.0, permanent_prune_on_epoch=-1, permanent_prune_on_epoch_percent=90, momentum=0.9, lr=0.01, weight_decay=0.0005, test_freq=1, contpermuted_beta=4, optimizer='bgd_new_update', optimizer_params='{}', inference_mc=False, inference_map=True, inference_committee=False, inference_aggsoftmax=False, inference_initstd=False, committee_size=0, test_mc_iters=0, init_params=['{"bias_type":', '"xavier",', '"conv_type":', '"xavier",', '"bn_init":', '"01"}'], desc='', bw_to_rgb=False, permuted_offset=False, labels_trick=False, num_of_permutations=4, iterations_per_virtual_epc=67, separate_labels_space=False, permute_seed=2019, federated_learning=True, n_clients=5, num_aggs_per_task=1, grad_clip=True, max_grad_norm=1.0, non_iid_split=True, alpha=0.01, alpha_mg=0.25)
[2024-09-07 22:12:43 Info] Computer name: test-desktop with pytorch version: 2.2.2
Dataset is  ds_cont_permuted_mnist
[2024-09-07 22:12:43 Info] Arguments are Namespace(dataset='ds_cont_permuted_mnist', nn_arch='mnist_simple_net_200width_domainlearning_784input_10cls_1ds', logname='continous_permuted_mnist_5_tasks', results_dir='ds_cont_permuted_mnist_5_tasks_50_epochs_alpha_0.01_data_type_non_iid_3.0_mean_eta__bgd_new_update_optim_4_beta_with_grad_clip_03:42_08-09-2024', seed=1000, num_workers=8, num_epochs=50, batch_size=128, pruning_percents=[], train_mc_iters=10, std_init=0.05, mean_eta=3.0, permanent_prune_on_epoch=-1, permanent_prune_on_epoch_percent=90, momentum=0.9, lr=0.01, weight_decay=0.0005, test_freq=1, contpermuted_beta=4, optimizer='bgd_new_update', optimizer_params='{}', inference_mc=False, inference_map=True, inference_committee=False, inference_aggsoftmax=False, inference_initstd=False, committee_size=0, test_mc_iters=0, init_params=['{"bias_type":', '"xavier",', '"conv_type":', '"xavier",', '"bn_init":', '"01"}'], desc='', bw_to_rgb=False, permuted_offset=False, labels_trick=False, num_of_permutations=4, iterations_per_virtual_epc=67, separate_labels_space=False, permute_seed=2019, federated_learning=True, n_clients=5, num_aggs_per_task=1, grad_clip=True, max_grad_norm=1.0, non_iid_split=True, alpha=0.01, alpha_mg=0.25)
Took 7.000000000000001% of the P-MNSIT dataset
Took 7.000000000000001% of the P-MNSIT dataset
Took 7.000000000000001% of the P-MNSIT dataset
Took 7.000000000000001% of the P-MNSIT dataset
Took 7.000000000000001% of the P-MNSIT dataset
round_end_iters list [ 837 1507 2177 2847 3350]
[ 837 1507 2177 2847 3350]
5
Client Indices Generation starts
Non-IID split is happening and alpha is 0.01
Non-IID split is happening and alpha is 0.01
Non-IID split is happening and alpha is 0.01
Non-IID split is happening and alpha is 0.01
Non-IID split is happening and alpha is 0.01
Clients Indices Generation ends
Client Indices Generation took 7.921695232391357 seconds
1
[2024-09-07 22:12:52 Info] Transformed model to CUDA
[2024-09-07 22:12:52 Info] Initialized 0 Conv2d layers using nn.init.xavier_normal_
[2024-09-07 22:12:52 Info] Initialized 3 linear layers using xavier
[2024-09-07 22:12:52 Info] Initialized 0 bias conv2d layers using nn.init.xavier.noraml_
[2024-09-07 22:12:52 Info] Initialized 3 bias linear layers using xavier
[2024-09-07 22:12:52 Info] Initialized 0 BN layers using weight=1 and bias=0
[2024-09-07 22:12:52 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
0
[2024-09-07 22:12:52 Info] Inference method: {'map'}
[2024-09-07 22:12:52 Info] Number of parameters in the model is 199,210
[2024-09-07 22:12:52 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-07 22:12:52 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:12:52 Info] Gradient clipping with max_norm being done
Model id is  139883420727136
Model value at client 1 is -0.9189211130142212 in round 1
[2024-09-07 22:12:52 Info] Training epoch number 1 with dataset number 0
[2024-09-07 22:13:07 Info] Client id 0, Epoch 1, train set, Iter 500 current average loss 1.3287
[2024-09-07 22:13:17 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-07 22:13:18 Info] Stats for test [map] set of size 10000, loss is 2.5271, acc is 10.13%
[2024-09-07 22:13:18 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-07 22:13:18 Info] Stats for test [map] set of size 10000, loss is 2.5687, acc is 11.62%
[2024-09-07 22:13:18 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-07 22:13:19 Info] Stats for test [map] set of size 10000, loss is 2.6092, acc is 10.1%
[2024-09-07 22:13:19 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-07 22:13:20 Info] Stats for test [map] set of size 10000, loss is 2.5455, acc is 10.1%
[2024-09-07 22:13:20 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-07 22:13:20 Info] Stats for test [map] set of size 10000, loss is 2.5667, acc is 10.1%
[2024-09-07 22:13:20 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 10.41
[2024-09-07 22:13:21 Info] Finished epoch number 1, Took 28 seconds
Round - 1,Client - 1
837, 0, 837
[2024-09-07 22:13:21 Info] Inference method: {'map'}
[2024-09-07 22:13:21 Info] Number of parameters in the model is 199,210
[2024-09-07 22:13:21 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-07 22:13:21 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:13:21 Info] Gradient clipping with max_norm being done
Model id is  139883262973056
Model value at client 2 is -0.9189211130142212 in round 1
[2024-09-07 22:13:21 Info] Training epoch number 1 with dataset number 0
[2024-09-07 22:13:36 Info] Client id 1, Epoch 1, train set, Iter 500 current average loss 1.2827
[2024-09-07 22:13:46 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-07 22:13:46 Info] Stats for test [map] set of size 10000, loss is 2.7, acc is 9.58%
[2024-09-07 22:13:46 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-07 22:13:47 Info] Stats for test [map] set of size 10000, loss is 4.8871, acc is 9.58%
[2024-09-07 22:13:47 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-07 22:13:48 Info] Stats for test [map] set of size 10000, loss is 3.0184, acc is 9.58%
[2024-09-07 22:13:48 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-07 22:13:48 Info] Stats for test [map] set of size 10000, loss is 3.1208, acc is 9.58%
[2024-09-07 22:13:48 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-07 22:13:49 Info] Stats for test [map] set of size 10000, loss is 2.9311, acc is 9.58%
[2024-09-07 22:13:49 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 9.58
[2024-09-07 22:13:49 Info] Finished epoch number 1, Took 28 seconds
Round - 1,Client - 2
837, 0, 837
[2024-09-07 22:13:49 Info] Inference method: {'map'}
[2024-09-07 22:13:49 Info] Number of parameters in the model is 199,210
[2024-09-07 22:13:49 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-07 22:13:49 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:13:49 Info] Gradient clipping with max_norm being done
Model id is  139885145121664
Model value at client 3 is -0.9189211130142212 in round 1
[2024-09-07 22:13:49 Info] Training epoch number 1 with dataset number 0
[2024-09-07 22:14:04 Info] Client id 2, Epoch 1, train set, Iter 500 current average loss 1.0435
[2024-09-07 22:14:14 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-07 22:14:15 Info] Stats for test [map] set of size 10000, loss is 2.4329, acc is 9.55%
[2024-09-07 22:14:15 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-07 22:14:16 Info] Stats for test [map] set of size 10000, loss is 2.3948, acc is 20.52%
[2024-09-07 22:14:16 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-07 22:14:16 Info] Stats for test [map] set of size 10000, loss is 2.5388, acc is 10.76%
[2024-09-07 22:14:16 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-07 22:14:17 Info] Stats for test [map] set of size 10000, loss is 2.5466, acc is 11.78%
[2024-09-07 22:14:17 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-07 22:14:18 Info] Stats for test [map] set of size 10000, loss is 2.5104, acc is 10.26%
[2024-09-07 22:14:18 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 12.574
[2024-09-07 22:14:18 Info] Finished epoch number 1, Took 28 seconds
Round - 1,Client - 3
837, 0, 837
[2024-09-07 22:14:18 Info] Inference method: {'map'}
[2024-09-07 22:14:18 Info] Number of parameters in the model is 199,210
[2024-09-07 22:14:18 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-07 22:14:18 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:14:18 Info] Gradient clipping with max_norm being done
Model id is  139883262979440
Model value at client 4 is -0.9189211130142212 in round 1
[2024-09-07 22:14:18 Info] Training epoch number 1 with dataset number 0
[2024-09-07 22:14:33 Info] Client id 3, Epoch 1, train set, Iter 500 current average loss 1.1923
[2024-09-07 22:14:43 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-07 22:14:43 Info] Stats for test [map] set of size 10000, loss is 2.7509, acc is 10.32%
[2024-09-07 22:14:43 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-07 22:14:44 Info] Stats for test [map] set of size 10000, loss is 2.7236, acc is 10.41%
[2024-09-07 22:14:44 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-07 22:14:45 Info] Stats for test [map] set of size 10000, loss is 2.8482, acc is 10.32%
[2024-09-07 22:14:45 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-07 22:14:45 Info] Stats for test [map] set of size 10000, loss is 2.8291, acc is 10.32%
[2024-09-07 22:14:45 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-07 22:14:46 Info] Stats for test [map] set of size 10000, loss is 2.814, acc is 10.32%
[2024-09-07 22:14:46 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 10.338
[2024-09-07 22:14:46 Info] Finished epoch number 1, Took 28 seconds
Round - 1,Client - 4
837, 0, 837
[2024-09-07 22:14:46 Info] Inference method: {'map'}
[2024-09-07 22:14:46 Info] Number of parameters in the model is 199,210
[2024-09-07 22:14:46 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-09-07 22:14:46 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:14:46 Info] Gradient clipping with max_norm being done
Model id is  139883262976128
Model value at client 5 is -0.9189211130142212 in round 1
[2024-09-07 22:14:46 Info] Training epoch number 1 with dataset number 0
[2024-09-07 22:15:01 Info] Client id 4, Epoch 1, train set, Iter 500 current average loss 1.0133
[2024-09-07 22:15:11 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-09-07 22:15:12 Info] Stats for test [map] set of size 10000, loss is 2.7024, acc is 9.73%
[2024-09-07 22:15:12 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-09-07 22:15:12 Info] Stats for test [map] set of size 10000, loss is 3.1943, acc is 19.28%
[2024-09-07 22:15:12 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-09-07 22:15:13 Info] Stats for test [map] set of size 10000, loss is 2.8979, acc is 10.91%
[2024-09-07 22:15:13 Info] Running test set for epoch number 1 for dataset idx 3 using map
[2024-09-07 22:15:14 Info] Stats for test [map] set of size 10000, loss is 2.7616, acc is 13.06%
[2024-09-07 22:15:14 Info] Running test set for epoch number 1 for dataset idx 4 using map
[2024-09-07 22:15:14 Info] Stats for test [map] set of size 10000, loss is 2.8907, acc is 10.23%
[2024-09-07 22:15:14 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 4 using map is 12.642
[2024-09-07 22:15:14 Info] Finished epoch number 1, Took 28 seconds
Round - 1,Client - 5
837, 0, 837
[2024-09-07 22:15:15 Info] Task wise accuracies after round 1 are [10.13]
[2024-09-07 22:15:15 Info] Client 0 task-wise loss and accuracies are - ([2.527], [10.13])
[2024-09-07 22:15:15 Info] Task wise accuracies after round 1 are [9.58]
[2024-09-07 22:15:15 Info] Client 1 task-wise loss and accuracies are - ([2.699], [9.58])
[2024-09-07 22:15:16 Info] Task wise accuracies after round 1 are [9.55]
[2024-09-07 22:15:16 Info] Client 2 task-wise loss and accuracies are - ([2.434], [9.55])
[2024-09-07 22:15:16 Info] Task wise accuracies after round 1 are [10.32]
[2024-09-07 22:15:16 Info] Client 3 task-wise loss and accuracies are - ([2.752], [10.32])
[2024-09-07 22:15:17 Info] Task wise accuracies after round 1 are [9.73]
[2024-09-07 22:15:17 Info] Client 4 task-wise loss and accuracies are - ([2.705], [9.73])
[2024-09-07 22:15:17 Info] Task wise accuracies after round 1 are [5.54]
[2024-09-07 22:15:17 Info] Value of server model at round 1 is 13.55526351928711
[2024-09-07 22:15:17 Info] Aggregated model avg acc and avg loss - (5.54, 2.49)
[2024-09-07 22:15:17 Info] Round - 1 complete
1
[2024-09-07 22:15:17 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:15:17 Info] Gradient clipping with max_norm being done
Model id is  139883420720704
Model value at client 1 is 13.55526351928711 in round 2
[2024-09-07 22:15:17 Info] Training epoch number 2 with dataset number 0
[2024-09-07 22:15:33 Info] Client id 0, Epoch 2, train set, Iter 500 current average loss 1.4703
[2024-09-07 22:15:38 Info] Running test set for epoch number 2 for dataset idx 0 using map
[2024-09-07 22:15:38 Info] Stats for test [map] set of size 10000, loss is 2.465, acc is 11.48%
[2024-09-07 22:15:38 Info] Running test set for epoch number 2 for dataset idx 1 using map
[2024-09-07 22:15:39 Info] Stats for test [map] set of size 10000, loss is 2.3502, acc is 11.37%
[2024-09-07 22:15:39 Info] Running test set for epoch number 2 for dataset idx 2 using map
[2024-09-07 22:15:39 Info] Stats for test [map] set of size 10000, loss is 2.469, acc is 12.53%
[2024-09-07 22:15:39 Info] Running test set for epoch number 2 for dataset idx 3 using map
[2024-09-07 22:15:40 Info] Stats for test [map] set of size 10000, loss is 2.4878, acc is 11.35%
[2024-09-07 22:15:40 Info] Running test set for epoch number 2 for dataset idx 4 using map
[2024-09-07 22:15:41 Info] Stats for test [map] set of size 10000, loss is 2.4839, acc is 11.35%
[2024-09-07 22:15:41 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 4 using map is 11.616
[2024-09-07 22:15:41 Info] Finished epoch number 2, Took 23 seconds
Round - 2,Client - 1
1507, 837, 1507
[2024-09-07 22:15:41 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:15:41 Info] Gradient clipping with max_norm being done
Model id is  139883263082208
Model value at client 2 is 13.55526351928711 in round 2
[2024-09-07 22:15:41 Info] Training epoch number 2 with dataset number 0
[2024-09-07 22:15:57 Info] Client id 1, Epoch 2, train set, Iter 500 current average loss 0.1431
[2024-09-07 22:16:02 Info] Running test set for epoch number 2 for dataset idx 0 using map
[2024-09-07 22:16:02 Info] Stats for test [map] set of size 10000, loss is 3.0604, acc is 10.1%
[2024-09-07 22:16:02 Info] Running test set for epoch number 2 for dataset idx 1 using map
[2024-09-07 22:16:03 Info] Stats for test [map] set of size 10000, loss is 2.8299, acc is 10.1%
[2024-09-07 22:16:03 Info] Running test set for epoch number 2 for dataset idx 2 using map
[2024-09-07 22:16:04 Info] Stats for test [map] set of size 10000, loss is 4.4518, acc is 10.14%
[2024-09-07 22:16:04 Info] Running test set for epoch number 2 for dataset idx 3 using map
[2024-09-07 22:16:04 Info] Stats for test [map] set of size 10000, loss is 3.185, acc is 10.1%
[2024-09-07 22:16:04 Info] Running test set for epoch number 2 for dataset idx 4 using map
[2024-09-07 22:16:05 Info] Stats for test [map] set of size 10000, loss is 3.1531, acc is 10.1%
[2024-09-07 22:16:05 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 4 using map is 10.108
[2024-09-07 22:16:05 Info] Finished epoch number 2, Took 24 seconds
Round - 2,Client - 2
1507, 837, 1507
[2024-09-07 22:16:05 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:16:05 Info] Gradient clipping with max_norm being done
Model id is  139885145125264
Model value at client 3 is 13.55526351928711 in round 2
[2024-09-07 22:16:05 Info] Training epoch number 2 with dataset number 0
[2024-09-07 22:16:21 Info] Client id 2, Epoch 2, train set, Iter 500 current average loss 1.2356
[2024-09-07 22:16:26 Info] Running test set for epoch number 2 for dataset idx 0 using map
[2024-09-07 22:16:27 Info] Stats for test [map] set of size 10000, loss is 2.5414, acc is 9.58%
[2024-09-07 22:16:27 Info] Running test set for epoch number 2 for dataset idx 1 using map
[2024-09-07 22:16:28 Info] Stats for test [map] set of size 10000, loss is 2.5173, acc is 9.58%
[2024-09-07 22:16:28 Info] Running test set for epoch number 2 for dataset idx 2 using map
[2024-09-07 22:16:28 Info] Stats for test [map] set of size 10000, loss is 2.5381, acc is 10.59%
[2024-09-07 22:16:28 Info] Running test set for epoch number 2 for dataset idx 3 using map
[2024-09-07 22:16:29 Info] Stats for test [map] set of size 10000, loss is 2.5897, acc is 9.58%
[2024-09-07 22:16:29 Info] Running test set for epoch number 2 for dataset idx 4 using map
[2024-09-07 22:16:30 Info] Stats for test [map] set of size 10000, loss is 2.5278, acc is 9.58%
[2024-09-07 22:16:30 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 4 using map is 9.782
[2024-09-07 22:16:30 Info] Finished epoch number 2, Took 24 seconds
Round - 2,Client - 3
1507, 837, 1507
[2024-09-07 22:16:30 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:16:30 Info] Gradient clipping with max_norm being done
Model id is  139885145121808
Model value at client 4 is 13.55526351928711 in round 2
[2024-09-07 22:16:30 Info] Training epoch number 2 with dataset number 0
[2024-09-07 22:16:45 Info] Client id 3, Epoch 2, train set, Iter 500 current average loss 1.1641
[2024-09-07 22:16:50 Info] Running test set for epoch number 2 for dataset idx 0 using map
[2024-09-07 22:16:50 Info] Stats for test [map] set of size 10000, loss is 2.4563, acc is 9.82%
[2024-09-07 22:16:50 Info] Running test set for epoch number 2 for dataset idx 1 using map
[2024-09-07 22:16:51 Info] Stats for test [map] set of size 10000, loss is 2.3238, acc is 9.85%
[2024-09-07 22:16:51 Info] Running test set for epoch number 2 for dataset idx 2 using map
[2024-09-07 22:16:52 Info] Stats for test [map] set of size 10000, loss is 2.597, acc is 10.3%
[2024-09-07 22:16:52 Info] Running test set for epoch number 2 for dataset idx 3 using map
[2024-09-07 22:16:52 Info] Stats for test [map] set of size 10000, loss is 2.4858, acc is 9.82%
[2024-09-07 22:16:52 Info] Running test set for epoch number 2 for dataset idx 4 using map
[2024-09-07 22:16:53 Info] Stats for test [map] set of size 10000, loss is 2.5213, acc is 9.82%
[2024-09-07 22:16:53 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 4 using map is 9.922
[2024-09-07 22:16:53 Info] Finished epoch number 2, Took 23 seconds
Round - 2,Client - 4
1507, 837, 1507
[2024-09-07 22:16:53 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:16:53 Info] Gradient clipping with max_norm being done
Model id is  139885145125648
Model value at client 5 is 13.55526351928711 in round 2
[2024-09-07 22:16:53 Info] Training epoch number 2 with dataset number 0
[2024-09-07 22:17:09 Info] Client id 4, Epoch 2, train set, Iter 500 current average loss 1.222
[2024-09-07 22:17:14 Info] Running test set for epoch number 2 for dataset idx 0 using map
[2024-09-07 22:17:14 Info] Stats for test [map] set of size 10000, loss is 2.6175, acc is 9.8%
[2024-09-07 22:17:14 Info] Running test set for epoch number 2 for dataset idx 1 using map
[2024-09-07 22:17:15 Info] Stats for test [map] set of size 10000, loss is 2.5236, acc is 9.86%
[2024-09-07 22:17:15 Info] Running test set for epoch number 2 for dataset idx 2 using map
[2024-09-07 22:17:16 Info] Stats for test [map] set of size 10000, loss is 2.596, acc is 17.47%
[2024-09-07 22:17:16 Info] Running test set for epoch number 2 for dataset idx 3 using map
[2024-09-07 22:17:16 Info] Stats for test [map] set of size 10000, loss is 2.7314, acc is 9.8%
[2024-09-07 22:17:16 Info] Running test set for epoch number 2 for dataset idx 4 using map
[2024-09-07 22:17:17 Info] Stats for test [map] set of size 10000, loss is 2.6213, acc is 9.81%
[2024-09-07 22:17:17 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 4 using map is 11.348
[2024-09-07 22:17:17 Info] Finished epoch number 2, Took 23 seconds
Round - 2,Client - 5
1507, 837, 1507
[2024-09-07 22:17:18 Info] Task wise accuracies after round 2 are [11.48, 11.37]
[2024-09-07 22:17:18 Info] Client 0 task-wise loss and accuracies are - ([2.466, 2.35], [11.48, 11.37])
[2024-09-07 22:17:20 Info] Task wise accuracies after round 2 are [10.1, 10.1]
[2024-09-07 22:17:20 Info] Client 1 task-wise loss and accuracies are - ([3.061, 2.83], [10.1, 10.1])
[2024-09-07 22:17:21 Info] Task wise accuracies after round 2 are [9.58, 9.58]
[2024-09-07 22:17:21 Info] Client 2 task-wise loss and accuracies are - ([2.541, 2.517], [9.58, 9.58])
[2024-09-07 22:17:22 Info] Task wise accuracies after round 2 are [9.82, 9.85]
[2024-09-07 22:17:22 Info] Client 3 task-wise loss and accuracies are - ([2.456, 2.323], [9.82, 9.85])
[2024-09-07 22:17:23 Info] Task wise accuracies after round 2 are [9.8, 9.86]
[2024-09-07 22:17:23 Info] Client 4 task-wise loss and accuracies are - ([2.619, 2.525], [9.8, 9.86])
[2024-09-07 22:17:24 Info] Task wise accuracies after round 2 are [8.91, 12.68]
[2024-09-07 22:17:24 Info] Value of server model at round 2 is -42.96506118774414
[2024-09-07 22:17:24 Info] Aggregated model avg acc and avg loss - (10.795, 2.361)
[2024-09-07 22:17:24 Info] Round - 2 complete
2
[2024-09-07 22:17:24 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:17:24 Info] Gradient clipping with max_norm being done
Model id is  139885145128624
Model value at client 1 is -42.96506118774414 in round 3
[2024-09-07 22:17:24 Info] Training epoch number 3 with dataset number 0
[2024-09-07 22:17:40 Info] Client id 0, Epoch 3, train set, Iter 500 current average loss 1.304
[2024-09-07 22:17:45 Info] Running test set for epoch number 3 for dataset idx 0 using map
[2024-09-07 22:17:45 Info] Stats for test [map] set of size 10000, loss is 2.4051, acc is 9.74%
[2024-09-07 22:17:45 Info] Running test set for epoch number 3 for dataset idx 1 using map
[2024-09-07 22:17:46 Info] Stats for test [map] set of size 10000, loss is 2.2916, acc is 9.73%
[2024-09-07 22:17:46 Info] Running test set for epoch number 3 for dataset idx 2 using map
[2024-09-07 22:17:47 Info] Stats for test [map] set of size 10000, loss is 2.3095, acc is 9.75%
[2024-09-07 22:17:47 Info] Running test set for epoch number 3 for dataset idx 3 using map
[2024-09-07 22:17:47 Info] Stats for test [map] set of size 10000, loss is 2.3927, acc is 10.91%
[2024-09-07 22:17:47 Info] Running test set for epoch number 3 for dataset idx 4 using map
[2024-09-07 22:17:48 Info] Stats for test [map] set of size 10000, loss is 2.4178, acc is 9.75%
[2024-09-07 22:17:48 Info] Average accuracy over all tasks for epoch number 3 for dataset idx 4 using map is 9.976
[2024-09-07 22:17:48 Info] Finished epoch number 3, Took 23 seconds
Round - 3,Client - 1
2177, 1507, 2177
[2024-09-07 22:17:48 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:17:48 Info] Gradient clipping with max_norm being done
Model id is  139885145124400
Model value at client 2 is -42.96506118774414 in round 3
[2024-09-07 22:17:48 Info] Training epoch number 3 with dataset number 0
[2024-09-07 22:18:03 Info] Client id 1, Epoch 3, train set, Iter 500 current average loss 1.2984
[2024-09-07 22:18:08 Info] Running test set for epoch number 3 for dataset idx 0 using map
[2024-09-07 22:18:09 Info] Stats for test [map] set of size 10000, loss is 2.6024, acc is 7.85%
[2024-09-07 22:18:09 Info] Running test set for epoch number 3 for dataset idx 1 using map
[2024-09-07 22:18:10 Info] Stats for test [map] set of size 10000, loss is 2.5278, acc is 9.83%
[2024-09-07 22:18:10 Info] Running test set for epoch number 3 for dataset idx 2 using map
[2024-09-07 22:18:10 Info] Stats for test [map] set of size 10000, loss is 2.4241, acc is 9.83%
[2024-09-07 22:18:10 Info] Running test set for epoch number 3 for dataset idx 3 using map
[2024-09-07 22:18:11 Info] Stats for test [map] set of size 10000, loss is 2.6551, acc is 14.95%
[2024-09-07 22:18:11 Info] Running test set for epoch number 3 for dataset idx 4 using map
[2024-09-07 22:18:12 Info] Stats for test [map] set of size 10000, loss is 2.6876, acc is 9.8%
[2024-09-07 22:18:12 Info] Average accuracy over all tasks for epoch number 3 for dataset idx 4 using map is 10.452
[2024-09-07 22:18:12 Info] Finished epoch number 3, Took 23 seconds
Round - 3,Client - 2
2177, 1507, 2177
[2024-09-07 22:18:12 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:18:12 Info] Gradient clipping with max_norm being done
Model id is  139885145125216
Model value at client 3 is -42.96506118774414 in round 3
[2024-09-07 22:18:12 Info] Training epoch number 3 with dataset number 0
[2024-09-07 22:18:28 Info] Client id 2, Epoch 3, train set, Iter 500 current average loss 0.9822
[2024-09-07 22:18:32 Info] Running test set for epoch number 3 for dataset idx 0 using map
[2024-09-07 22:18:33 Info] Stats for test [map] set of size 10000, loss is 3.0305, acc is 8.92%
[2024-09-07 22:18:33 Info] Running test set for epoch number 3 for dataset idx 1 using map
[2024-09-07 22:18:34 Info] Stats for test [map] set of size 10000, loss is 2.857, acc is 8.92%
[2024-09-07 22:18:34 Info] Running test set for epoch number 3 for dataset idx 2 using map
[2024-09-07 22:18:34 Info] Stats for test [map] set of size 10000, loss is 2.7359, acc is 8.92%
[2024-09-07 22:18:34 Info] Running test set for epoch number 3 for dataset idx 3 using map
[2024-09-07 22:18:35 Info] Stats for test [map] set of size 10000, loss is 4.1512, acc is 9.05%
[2024-09-07 22:18:35 Info] Running test set for epoch number 3 for dataset idx 4 using map
[2024-09-07 22:18:36 Info] Stats for test [map] set of size 10000, loss is 3.0293, acc is 8.92%
[2024-09-07 22:18:36 Info] Average accuracy over all tasks for epoch number 3 for dataset idx 4 using map is 8.946
[2024-09-07 22:18:36 Info] Finished epoch number 3, Took 24 seconds
Round - 3,Client - 3
2177, 1507, 2177
[2024-09-07 22:18:36 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:18:36 Info] Gradient clipping with max_norm being done
Model id is  139883420721328
Model value at client 4 is -42.96506118774414 in round 3
[2024-09-07 22:18:36 Info] Training epoch number 3 with dataset number 0
[2024-09-07 22:18:51 Info] Client id 3, Epoch 3, train set, Iter 500 current average loss 1.1853
[2024-09-07 22:18:56 Info] Running test set for epoch number 3 for dataset idx 0 using map
[2024-09-07 22:18:57 Info] Stats for test [map] set of size 10000, loss is 3.1559, acc is 11.35%
[2024-09-07 22:18:57 Info] Running test set for epoch number 3 for dataset idx 1 using map
[2024-09-07 22:18:57 Info] Stats for test [map] set of size 10000, loss is 3.2799, acc is 11.35%
[2024-09-07 22:18:57 Info] Running test set for epoch number 3 for dataset idx 2 using map
[2024-09-07 22:18:58 Info] Stats for test [map] set of size 10000, loss is 3.0004, acc is 11.35%
[2024-09-07 22:18:58 Info] Running test set for epoch number 3 for dataset idx 3 using map
[2024-09-07 22:18:59 Info] Stats for test [map] set of size 10000, loss is 3.9777, acc is 17.23%
[2024-09-07 22:18:59 Info] Running test set for epoch number 3 for dataset idx 4 using map
[2024-09-07 22:19:00 Info] Stats for test [map] set of size 10000, loss is 3.2361, acc is 11.35%
[2024-09-07 22:19:00 Info] Average accuracy over all tasks for epoch number 3 for dataset idx 4 using map is 12.526
[2024-09-07 22:19:00 Info] Finished epoch number 3, Took 23 seconds
Round - 3,Client - 4
2177, 1507, 2177
[2024-09-07 22:19:00 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:19:00 Info] Gradient clipping with max_norm being done
Model id is  139883420727472
Model value at client 5 is -42.96506118774414 in round 3
[2024-09-07 22:19:00 Info] Training epoch number 3 with dataset number 0
[2024-09-07 22:19:15 Info] Client id 4, Epoch 3, train set, Iter 500 current average loss 0.8967
[2024-09-07 22:19:20 Info] Running test set for epoch number 3 for dataset idx 0 using map
[2024-09-07 22:19:21 Info] Stats for test [map] set of size 10000, loss is 2.5962, acc is 9.82%
[2024-09-07 22:19:21 Info] Running test set for epoch number 3 for dataset idx 1 using map
[2024-09-07 22:19:22 Info] Stats for test [map] set of size 10000, loss is 2.52, acc is 9.82%
[2024-09-07 22:19:22 Info] Running test set for epoch number 3 for dataset idx 2 using map
[2024-09-07 22:19:22 Info] Stats for test [map] set of size 10000, loss is 2.5981, acc is 9.82%
[2024-09-07 22:19:22 Info] Running test set for epoch number 3 for dataset idx 3 using map
[2024-09-07 22:19:23 Info] Stats for test [map] set of size 10000, loss is 2.9178, acc is 13.17%
[2024-09-07 22:19:23 Info] Running test set for epoch number 3 for dataset idx 4 using map
[2024-09-07 22:19:24 Info] Stats for test [map] set of size 10000, loss is 2.7934, acc is 9.82%
[2024-09-07 22:19:24 Info] Average accuracy over all tasks for epoch number 3 for dataset idx 4 using map is 10.49
[2024-09-07 22:19:24 Info] Finished epoch number 3, Took 24 seconds
Round - 3,Client - 5
2177, 1507, 2177
[2024-09-07 22:19:26 Info] Task wise accuracies after round 3 are [9.74, 9.73, 9.75]
[2024-09-07 22:19:26 Info] Client 0 task-wise loss and accuracies are - ([2.406, 2.292, 2.31], [9.74, 9.73, 9.75])
[2024-09-07 22:19:27 Info] Task wise accuracies after round 3 are [7.85, 9.83, 9.83]
[2024-09-07 22:19:27 Info] Client 1 task-wise loss and accuracies are - ([2.603, 2.528, 2.424], [7.85, 9.83, 9.83])
[2024-09-07 22:19:29 Info] Task wise accuracies after round 3 are [8.92, 8.92, 8.92]
[2024-09-07 22:19:29 Info] Client 2 task-wise loss and accuracies are - ([3.031, 2.856, 2.735], [8.92, 8.92, 8.92])
[2024-09-07 22:19:31 Info] Task wise accuracies after round 3 are [11.35, 11.35, 11.35]
[2024-09-07 22:19:31 Info] Client 3 task-wise loss and accuracies are - ([3.157, 3.28, 3.001], [11.35, 11.35, 11.35])
[2024-09-07 22:19:33 Info] Task wise accuracies after round 3 are [9.82, 9.82, 9.82]
[2024-09-07 22:19:33 Info] Client 4 task-wise loss and accuracies are - ([2.595, 2.52, 2.598], [9.82, 9.82, 9.82])
[2024-09-07 22:19:35 Info] Task wise accuracies after round 3 are [9.51, 12.3, 22.53]
[2024-09-07 22:19:35 Info] Value of server model at round 3 is -56.49483871459961
[2024-09-07 22:19:35 Info] Aggregated model avg acc and avg loss - (14.78, 2.32)
[2024-09-07 22:19:35 Info] Round - 3 complete
3
[2024-09-07 22:19:35 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:19:35 Info] Gradient clipping with max_norm being done
Model id is  139883262968832
Model value at client 1 is -56.49483871459961 in round 4
[2024-09-07 22:19:35 Info] Training epoch number 4 with dataset number 0
[2024-09-07 22:19:50 Info] Client id 0, Epoch 4, train set, Iter 500 current average loss 1.5028
[2024-09-07 22:19:55 Info] Running test set for epoch number 4 for dataset idx 0 using map
[2024-09-07 22:19:55 Info] Stats for test [map] set of size 10000, loss is 5.4723, acc is 10.11%
[2024-09-07 22:19:55 Info] Running test set for epoch number 4 for dataset idx 1 using map
[2024-09-07 22:19:56 Info] Stats for test [map] set of size 10000, loss is 4.7988, acc is 10.6%
[2024-09-07 22:19:56 Info] Running test set for epoch number 4 for dataset idx 2 using map
[2024-09-07 22:19:57 Info] Stats for test [map] set of size 10000, loss is 5.2027, acc is 10.26%
[2024-09-07 22:19:57 Info] Running test set for epoch number 4 for dataset idx 3 using map
[2024-09-07 22:19:58 Info] Stats for test [map] set of size 10000, loss is 4.6318, acc is 10.74%
[2024-09-07 22:19:58 Info] Running test set for epoch number 4 for dataset idx 4 using map
[2024-09-07 22:19:58 Info] Stats for test [map] set of size 10000, loss is 4.9626, acc is 18.19%
[2024-09-07 22:19:58 Info] Average accuracy over all tasks for epoch number 4 for dataset idx 4 using map is 11.98
[2024-09-07 22:19:58 Info] Finished epoch number 4, Took 23 seconds
Round - 4,Client - 1
2847, 2177, 2847
[2024-09-07 22:19:58 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:19:58 Info] Gradient clipping with max_norm being done
Model id is  139885145125792
Model value at client 2 is -56.49483871459961 in round 4
[2024-09-07 22:19:58 Info] Training epoch number 4 with dataset number 0
[2024-09-07 22:20:14 Info] Client id 1, Epoch 4, train set, Iter 500 current average loss 1.0587
[2024-09-07 22:20:20 Info] Running test set for epoch number 4 for dataset idx 0 using map
[2024-09-07 22:20:20 Info] Stats for test [map] set of size 10000, loss is 2.9488, acc is 9.81%
[2024-09-07 22:20:20 Info] Running test set for epoch number 4 for dataset idx 1 using map
[2024-09-07 22:20:21 Info] Stats for test [map] set of size 10000, loss is 2.8386, acc is 9.9%
[2024-09-07 22:20:21 Info] Running test set for epoch number 4 for dataset idx 2 using map
[2024-09-07 22:20:22 Info] Stats for test [map] set of size 10000, loss is 2.8898, acc is 9.82%
[2024-09-07 22:20:22 Info] Running test set for epoch number 4 for dataset idx 3 using map
[2024-09-07 22:20:23 Info] Stats for test [map] set of size 10000, loss is 2.8339, acc is 9.82%
[2024-09-07 22:20:23 Info] Running test set for epoch number 4 for dataset idx 4 using map
[2024-09-07 22:20:23 Info] Stats for test [map] set of size 10000, loss is 2.9841, acc is 18.82%
[2024-09-07 22:20:23 Info] Average accuracy over all tasks for epoch number 4 for dataset idx 4 using map is 11.634
[2024-09-07 22:20:23 Info] Finished epoch number 4, Took 24 seconds
Round - 4,Client - 2
2847, 2177, 2847
[2024-09-07 22:20:23 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:20:23 Info] Gradient clipping with max_norm being done
Model id is  139885145116192
Model value at client 3 is -56.49483871459961 in round 4
[2024-09-07 22:20:23 Info] Training epoch number 4 with dataset number 0
[2024-09-07 22:20:40 Info] Client id 2, Epoch 4, train set, Iter 500 current average loss 1.3843
[2024-09-07 22:20:45 Info] Running test set for epoch number 4 for dataset idx 0 using map
[2024-09-07 22:20:46 Info] Stats for test [map] set of size 10000, loss is 2.7499, acc is 9.7%
[2024-09-07 22:20:46 Info] Running test set for epoch number 4 for dataset idx 1 using map
[2024-09-07 22:20:46 Info] Stats for test [map] set of size 10000, loss is 2.6982, acc is 9.6%
[2024-09-07 22:20:46 Info] Running test set for epoch number 4 for dataset idx 2 using map
[2024-09-07 22:20:47 Info] Stats for test [map] set of size 10000, loss is 2.6055, acc is 13.99%
[2024-09-07 22:20:47 Info] Running test set for epoch number 4 for dataset idx 3 using map
[2024-09-07 22:20:48 Info] Stats for test [map] set of size 10000, loss is 2.5437, acc is 9.99%
[2024-09-07 22:20:48 Info] Running test set for epoch number 4 for dataset idx 4 using map
[2024-09-07 22:20:49 Info] Stats for test [map] set of size 10000, loss is 2.7695, acc is 17.74%
[2024-09-07 22:20:49 Info] Average accuracy over all tasks for epoch number 4 for dataset idx 4 using map is 12.204
[2024-09-07 22:20:49 Info] Finished epoch number 4, Took 25 seconds
Round - 4,Client - 3
2847, 2177, 2847
[2024-09-07 22:20:49 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:20:49 Info] Gradient clipping with max_norm being done
Model id is  139883420727232
Model value at client 4 is -56.49483871459961 in round 4
[2024-09-07 22:20:49 Info] Training epoch number 4 with dataset number 0
[2024-09-07 22:21:05 Info] Client id 3, Epoch 4, train set, Iter 500 current average loss 5.5861
[2024-09-07 22:21:10 Info] Running test set for epoch number 4 for dataset idx 0 using map
[2024-09-07 22:21:11 Info] Stats for test [map] set of size 10000, loss is 2.7357, acc is 11.36%
[2024-09-07 22:21:11 Info] Running test set for epoch number 4 for dataset idx 1 using map
[2024-09-07 22:21:12 Info] Stats for test [map] set of size 10000, loss is 2.6417, acc is 12.81%
[2024-09-07 22:21:12 Info] Running test set for epoch number 4 for dataset idx 2 using map
[2024-09-07 22:21:13 Info] Stats for test [map] set of size 10000, loss is 2.7584, acc is 10.52%
[2024-09-07 22:21:13 Info] Running test set for epoch number 4 for dataset idx 3 using map
[2024-09-07 22:21:13 Info] Stats for test [map] set of size 10000, loss is 2.6717, acc is 16.84%
[2024-09-07 22:21:13 Info] Running test set for epoch number 4 for dataset idx 4 using map
[2024-09-07 22:21:14 Info] Stats for test [map] set of size 10000, loss is 3.191, acc is 17.88%
[2024-09-07 22:21:14 Info] Average accuracy over all tasks for epoch number 4 for dataset idx 4 using map is 13.882
[2024-09-07 22:21:14 Info] Finished epoch number 4, Took 25 seconds
Round - 4,Client - 4
2847, 2177, 2847
[2024-09-07 22:21:14 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:21:14 Info] Gradient clipping with max_norm being done
Model id is  139885145123776
Model value at client 5 is -56.49483871459961 in round 4
[2024-09-07 22:21:14 Info] Training epoch number 4 with dataset number 0
[2024-09-07 22:21:30 Info] Client id 4, Epoch 4, train set, Iter 500 current average loss 1.3942
[2024-09-07 22:21:36 Info] Running test set for epoch number 4 for dataset idx 0 using map
[2024-09-07 22:21:36 Info] Stats for test [map] set of size 10000, loss is 2.6964, acc is 9.58%
[2024-09-07 22:21:36 Info] Running test set for epoch number 4 for dataset idx 1 using map
[2024-09-07 22:21:37 Info] Stats for test [map] set of size 10000, loss is 2.7199, acc is 9.66%
[2024-09-07 22:21:37 Info] Running test set for epoch number 4 for dataset idx 2 using map
[2024-09-07 22:21:38 Info] Stats for test [map] set of size 10000, loss is 2.5893, acc is 11.66%
[2024-09-07 22:21:38 Info] Running test set for epoch number 4 for dataset idx 3 using map
[2024-09-07 22:21:39 Info] Stats for test [map] set of size 10000, loss is 2.5148, acc is 9.63%
[2024-09-07 22:21:39 Info] Running test set for epoch number 4 for dataset idx 4 using map
[2024-09-07 22:21:39 Info] Stats for test [map] set of size 10000, loss is 2.6805, acc is 18.44%
[2024-09-07 22:21:39 Info] Average accuracy over all tasks for epoch number 4 for dataset idx 4 using map is 11.794
[2024-09-07 22:21:39 Info] Finished epoch number 4, Took 25 seconds
Round - 4,Client - 5
2847, 2177, 2847
[2024-09-07 22:21:42 Info] Task wise accuracies after round 4 are [10.11, 10.6, 10.26, 10.74]
[2024-09-07 22:21:42 Info] Client 0 task-wise loss and accuracies are - ([5.477, 4.802, 5.206, 4.633], [10.11, 10.6, 10.26, 10.74])
[2024-09-07 22:21:45 Info] Task wise accuracies after round 4 are [9.81, 9.9, 9.82, 9.82]
[2024-09-07 22:21:45 Info] Client 1 task-wise loss and accuracies are - ([2.949, 2.838, 2.89, 2.833], [9.81, 9.9, 9.82, 9.82])
[2024-09-07 22:21:48 Info] Task wise accuracies after round 4 are [9.7, 9.6, 13.99, 9.99]
[2024-09-07 22:21:48 Info] Client 2 task-wise loss and accuracies are - ([2.749, 2.697, 2.604, 2.542], [9.7, 9.6, 13.99, 9.99])
[2024-09-07 22:21:50 Info] Task wise accuracies after round 4 are [11.36, 12.81, 10.52, 16.84]
[2024-09-07 22:21:50 Info] Client 3 task-wise loss and accuracies are - ([2.736, 2.642, 2.76, 2.672], [11.36, 12.81, 10.52, 16.84])
[2024-09-07 22:21:53 Info] Task wise accuracies after round 4 are [9.58, 9.66, 11.66, 9.63]
[2024-09-07 22:21:53 Info] Client 4 task-wise loss and accuracies are - ([2.696, 2.72, 2.589, 2.514], [9.58, 9.66, 11.66, 9.63])
[2024-09-07 22:21:56 Info] Task wise accuracies after round 4 are [13.23, 18.18, 13.54, 16.21]
[2024-09-07 22:21:56 Info] Value of server model at round 4 is -128.5268096923828
[2024-09-07 22:21:56 Info] Aggregated model avg acc and avg loss - (15.29, 3.086)
[2024-09-07 22:21:56 Info] Round - 4 complete
4
[2024-09-07 22:21:56 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:21:56 Info] Gradient clipping with max_norm being done
Model id is  139883262970176
Model value at client 1 is -128.5268096923828 in round 5
[2024-09-07 22:21:56 Info] Training epoch number 5 with dataset number 0
[2024-09-07 22:22:12 Info] Client id 0, Epoch 5, train set, Iter 500 current average loss 346.8047
[2024-09-07 22:22:12 Info] Running test set for epoch number 5 for dataset idx 0 using map
[2024-09-07 22:22:13 Info] Stats for test [map] set of size 10000, loss is 1235.4461, acc is 11.35%
[2024-09-07 22:22:13 Info] Running test set for epoch number 5 for dataset idx 1 using map
[2024-09-07 22:22:14 Info] Stats for test [map] set of size 10000, loss is 1234.182, acc is 11.35%
[2024-09-07 22:22:14 Info] Running test set for epoch number 5 for dataset idx 2 using map
[2024-09-07 22:22:15 Info] Stats for test [map] set of size 10000, loss is 1231.0677, acc is 11.35%
[2024-09-07 22:22:15 Info] Running test set for epoch number 5 for dataset idx 3 using map
[2024-09-07 22:22:15 Info] Stats for test [map] set of size 10000, loss is 1223.7344, acc is 11.35%
[2024-09-07 22:22:15 Info] Running test set for epoch number 5 for dataset idx 4 using map
[2024-09-07 22:22:16 Info] Stats for test [map] set of size 10000, loss is 1082.1219, acc is 11.35%
[2024-09-07 22:22:16 Info] Average accuracy over all tasks for epoch number 5 for dataset idx 4 using map is 11.35
[2024-09-07 22:22:16 Info] Finished epoch number 5, Took 19 seconds
Round - 5,Client - 1
3350, 2847, 3350
[2024-09-07 22:22:16 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:22:16 Info] Gradient clipping with max_norm being done
Model id is  139883420727856
Model value at client 2 is -128.5268096923828 in round 5
[2024-09-07 22:22:16 Info] Training epoch number 5 with dataset number 0
[2024-09-07 22:22:32 Info] Client id 1, Epoch 5, train set, Iter 500 current average loss 4.2664
[2024-09-07 22:22:32 Info] Running test set for epoch number 5 for dataset idx 0 using map
[2024-09-07 22:22:33 Info] Stats for test [map] set of size 10000, loss is 70.4293, acc is 10.3%
[2024-09-07 22:22:33 Info] Running test set for epoch number 5 for dataset idx 1 using map
[2024-09-07 22:22:34 Info] Stats for test [map] set of size 10000, loss is 70.2679, acc is 10.32%
[2024-09-07 22:22:34 Info] Running test set for epoch number 5 for dataset idx 2 using map
[2024-09-07 22:22:34 Info] Stats for test [map] set of size 10000, loss is 70.3038, acc is 10.32%
[2024-09-07 22:22:34 Info] Running test set for epoch number 5 for dataset idx 3 using map
[2024-09-07 22:22:35 Info] Stats for test [map] set of size 10000, loss is 70.22, acc is 10.88%
[2024-09-07 22:22:35 Info] Running test set for epoch number 5 for dataset idx 4 using map
[2024-09-07 22:22:36 Info] Stats for test [map] set of size 10000, loss is 70.5049, acc is 17.85%
[2024-09-07 22:22:36 Info] Average accuracy over all tasks for epoch number 5 for dataset idx 4 using map is 11.934
[2024-09-07 22:22:36 Info] Finished epoch number 5, Took 19 seconds
Round - 5,Client - 2
3350, 2847, 3350
[2024-09-07 22:22:36 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:22:36 Info] Gradient clipping with max_norm being done
Model id is  139883420729200
Model value at client 3 is -128.5268096923828 in round 5
[2024-09-07 22:22:36 Info] Training epoch number 5 with dataset number 0
[2024-09-07 22:22:52 Info] Client id 2, Epoch 5, train set, Iter 500 current average loss 2.1788
[2024-09-07 22:22:52 Info] Running test set for epoch number 5 for dataset idx 0 using map
[2024-09-07 22:22:52 Info] Stats for test [map] set of size 10000, loss is 21.4719, acc is 9.58%
[2024-09-07 22:22:52 Info] Running test set for epoch number 5 for dataset idx 1 using map
[2024-09-07 22:22:53 Info] Stats for test [map] set of size 10000, loss is 21.5935, acc is 9.58%
[2024-09-07 22:22:53 Info] Running test set for epoch number 5 for dataset idx 2 using map
[2024-09-07 22:22:54 Info] Stats for test [map] set of size 10000, loss is 21.2741, acc is 9.58%
[2024-09-07 22:22:54 Info] Running test set for epoch number 5 for dataset idx 3 using map
[2024-09-07 22:22:55 Info] Stats for test [map] set of size 10000, loss is 21.2328, acc is 9.58%
[2024-09-07 22:22:55 Info] Running test set for epoch number 5 for dataset idx 4 using map
[2024-09-07 22:22:55 Info] Stats for test [map] set of size 10000, loss is 22.0221, acc is 9.86%
[2024-09-07 22:22:55 Info] Average accuracy over all tasks for epoch number 5 for dataset idx 4 using map is 9.636
[2024-09-07 22:22:55 Info] Finished epoch number 5, Took 19 seconds
Round - 5,Client - 3
3350, 2847, 3350
[2024-09-07 22:22:55 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:22:55 Info] Gradient clipping with max_norm being done
Model id is  139883420728816
Model value at client 4 is -128.5268096923828 in round 5
[2024-09-07 22:22:55 Info] Training epoch number 5 with dataset number 0
[2024-09-07 22:23:12 Info] Client id 3, Epoch 5, train set, Iter 500 current average loss 8.9803
[2024-09-07 22:23:12 Info] Running test set for epoch number 5 for dataset idx 0 using map
[2024-09-07 22:23:12 Info] Stats for test [map] set of size 10000, loss is 4.884, acc is 9.74%
[2024-09-07 22:23:12 Info] Running test set for epoch number 5 for dataset idx 1 using map
[2024-09-07 22:23:13 Info] Stats for test [map] set of size 10000, loss is 4.7978, acc is 9.8%
[2024-09-07 22:23:13 Info] Running test set for epoch number 5 for dataset idx 2 using map
[2024-09-07 22:23:14 Info] Stats for test [map] set of size 10000, loss is 4.8155, acc is 9.84%
[2024-09-07 22:23:14 Info] Running test set for epoch number 5 for dataset idx 3 using map
[2024-09-07 22:23:15 Info] Stats for test [map] set of size 10000, loss is 4.659, acc is 10.74%
[2024-09-07 22:23:15 Info] Running test set for epoch number 5 for dataset idx 4 using map
[2024-09-07 22:23:15 Info] Stats for test [map] set of size 10000, loss is 5.5364, acc is 10.61%
[2024-09-07 22:23:15 Info] Average accuracy over all tasks for epoch number 5 for dataset idx 4 using map is 10.146
[2024-09-07 22:23:15 Info] Finished epoch number 5, Took 19 seconds
Round - 5,Client - 4
3350, 2847, 3350
[2024-09-07 22:23:15 Info] BGD params: {'mean_eta': 3.0, 'std_init': 0.05, 'mc_iters': 10, 'alpha_mg': 0.25}
It's here in new bgd optimizer
[2024-09-07 22:23:15 Info] Gradient clipping with max_norm being done
Model id is  139883420720704
Model value at client 5 is -128.5268096923828 in round 5
[2024-09-07 22:23:15 Info] Training epoch number 5 with dataset number 0
